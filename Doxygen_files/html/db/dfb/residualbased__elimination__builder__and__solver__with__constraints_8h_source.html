<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KratosMultiphysics: /software/kratos/doxygen/kratos/solving_strategies/builder_and_solvers/residualbased_elimination_builder_and_solver_with_constraints.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../kratos_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">KratosMultiphysics
   </div>
   <div id="projectbrief">KRATOS Multiphysics (Kratos) is a framework for building parallel, multi-disciplinary simulation software, aiming at modularity, extensibility, and high performance. Kratos is written in C++, and counts with an extensive Python interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_8fc3e8efef0bfca4a113d719cbd52afb.html">kratos</a></li><li class="navelem"><a class="el" href="../../dir_fdea7736ef62293a5901d28bce787dd1.html">solving_strategies</a></li><li class="navelem"><a class="el" href="../../dir_84722a22f804f3734a04c6a9d1859e65.html">builder_and_solvers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">residualbased_elimination_builder_and_solver_with_constraints.h</div></div>
</div><!--header-->
<div class="contents">
<a href="../../db/dfb/residualbased__elimination__builder__and__solver__with__constraints_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">//    |  /           |</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//    &#39; /   __| _` | __|  _ \   __|</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">//    . \  |   (   | |   (   |\__ `</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">//   _|\_\_|  \__,_|\__|\___/ ____/</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">//                   Multi-Physics</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">//</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">//  License:         BSD License</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">//                     Kratos default license: kratos/license.txt</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">//</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">//  Main authors:    Vicente Mataix Ferrandiz</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">//</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">//</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#if !defined(KRATOS_RESIDUAL_BASED_ELIMINATION_BUILDER_AND_SOLVER_WITH_CONSTRAINTS)</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#define KRATOS_RESIDUAL_BASED_ELIMINATION_BUILDER_AND_SOLVER_WITH_CONSTRAINTS</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">/* System includes */</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;unordered_set&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;unordered_map&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment">/* External includes */</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">/* Project includes */</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &quot;<a class="code" href="../../dc/d74/residualbased__elimination__builder__and__solver_8h.html">solving_strategies/builder_and_solvers/residualbased_elimination_builder_and_solver.h</a>&quot;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="../../d5/d4e/sparse__matrix__multiplication__utility_8h.html">utilities/sparse_matrix_multiplication_utility.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="../../d8/dea/constraint__utilities_8h.html">utilities/constraint_utilities.h</a>&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &quot;<a class="code" href="../../d1/d8c/logger_8h.html">input_output/logger.h</a>&quot;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="../../df/d21/builtin__timer_8h.html">utilities/builtin_timer.h</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="../../de/d07/parallel__utilities_8h.html">utilities/parallel_utilities.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keyword">namespace </span><a class="code hl_namespace" href="../../db/d66/namespace_kratos.html">Kratos</a></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>{</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><span class="keyword">template</span> &lt;<span class="keyword">class </span>TSparseSpace,</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>          <span class="keyword">class </span>TDenseSpace,</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>          <span class="keyword">class </span>TLinearSolver</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>          &gt;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html">   91</a></span><span class="keyword">class </span><a class="code hl_class" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html">ResidualBasedEliminationBuilderAndSolverWithConstraints</a></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    : <span class="keyword">public</span> <a class="code hl_class" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html">ResidualBasedEliminationBuilderAndSolver</a>&lt;TSparseSpace, TDenseSpace, TLinearSolver&gt;</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>{</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>  <span class="keyword">public</span>:</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span> </div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6b5ea5ca519121ad054d0d6d0b42409a">   99</a></span>    <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6b5ea5ca519121ad054d0d6d0b42409a">KRATOS_CLASS_POINTER_DEFINITION</a>(<a class="code hl_class" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html">ResidualBasedEliminationBuilderAndSolverWithConstraints</a>);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a9ee1f8a0625fa03bd6c86071d0d7897e">  102</a></span>    <span class="keyword">typedef</span> <a class="code hl_class" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html">BuilderAndSolver&lt;TSparseSpace, TDenseSpace, TLinearSolver&gt;</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a9ee1f8a0625fa03bd6c86071d0d7897e">BuilderAndSolverBaseType</a>;</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6bcb2dbd5956d0ea25d821bc69130f76">  105</a></span>    <span class="keyword">typedef</span> <a class="code hl_class" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html">ResidualBasedEliminationBuilderAndSolver&lt;TSparseSpace, TDenseSpace, TLinearSolver&gt;</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6bcb2dbd5956d0ea25d821bc69130f76">BaseType</a>;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a30dcd2dbd25f060646de4cf210059138">  108</a></span>    <span class="keyword">typedef</span> <a class="code hl_class" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html">ResidualBasedEliminationBuilderAndSolverWithConstraints&lt;TSparseSpace, TDenseSpace, TLinearSolver&gt;</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a30dcd2dbd25f060646de4cf210059138">ClassType</a>;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    <span class="comment">// The size_t types</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad57451ea05aecad680fa5936b2cce345">  111</a></span>    <span class="keyword">typedef</span> std::size_t <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad57451ea05aecad680fa5936b2cce345">SizeType</a>;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">  112</a></span>    <span class="keyword">typedef</span> std::size_t <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a>;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span> </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a85bf823ea9d90b6a55b12b9668fcbd20">  115</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_class" href="../../d1/da3/class_kratos_1_1_scheme.html">BaseType::TSchemeType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a85bf823ea9d90b6a55b12b9668fcbd20">TSchemeType</a>;</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a34593b03e0bcbad3dbf51ccb1b59c4eb">  116</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a74c5805cee1dce8db5969a4cb0b6c501">BaseType::TDataType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a34593b03e0bcbad3dbf51ccb1b59c4eb">TDataType</a>;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad2ed4c63bee6cb6824710e29e367f145">  117</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a960c1b82952e6af3c87cb7c25bb7d77d">BaseType::DofsArrayType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad2ed4c63bee6cb6824710e29e367f145">DofsArrayType</a>;</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">  118</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#af66148cdea4b95987036ab66a7acc4c5">BaseType::TSystemMatrixType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">  119</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a7a5ab35c93a40a75aaaf8f65e905d56e">BaseType::TSystemVectorType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae469a111c2b8079ba9f70e7785406d36">  120</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a85c1ea369d1431be0b121442079b08f1">BaseType::LocalSystemVectorType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae469a111c2b8079ba9f70e7785406d36">LocalSystemVectorType</a>;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6aed94fbf245f3cf68d79c5171a68f94">  121</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a9f7606fca28422b0a30802b55229c46b">BaseType::LocalSystemMatrixType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6aed94fbf245f3cf68d79c5171a68f94">LocalSystemMatrixType</a>;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a27d137182d319891edae86abe9091ee5">  122</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a4035089c8a396ae112ec54e02a7ef407">BaseType::TSystemMatrixPointerType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a27d137182d319891edae86abe9091ee5">TSystemMatrixPointerType</a>;</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abbf8fabbf7de8150e696b3fb7804759c">  123</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a4706ad414b53ff8cb629ee2e8e4860d4">BaseType::TSystemVectorPointerType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abbf8fabbf7de8150e696b3fb7804759c">TSystemVectorPointerType</a>;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aad67015d1cdd20517f93fce3556c6d81">  124</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_class" href="../../d5/ddd/class_kratos_1_1_node.html">BaseType::NodeType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aad67015d1cdd20517f93fce3556c6d81">NodeType</a>;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a4214dcba4525bf5586d688f03f464d9d">  125</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#aa26494df4a0104218d26dcaa471f34a1">BaseType::NodesArrayType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a4214dcba4525bf5586d688f03f464d9d">NodesArrayType</a>;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a4757f6a4bfb8f4a10b2c6d5a8c55d907">  126</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#acae2dc76ff211019362a883c883159e0">BaseType::ElementsArrayType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a4757f6a4bfb8f4a10b2c6d5a8c55d907">ElementsArrayType</a>;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a45cc985b9e9eb40ed8337f0c70f29cbe">  127</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#aa6626f76a94936e5a6e6f08b98eeb6eb">BaseType::ConditionsArrayType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a45cc985b9e9eb40ed8337f0c70f29cbe">ConditionsArrayType</a>;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a0adb21d2fd429647bc6bbef5df7019ec">  130</a></span>    <span class="keyword">typedef</span> <a class="code hl_class" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">PointerVectorSet&lt;Element, IndexedObject&gt;</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a0adb21d2fd429647bc6bbef5df7019ec">ElementsContainerType</a>;</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a14a1cf543f739e81d992df895873fe34">  131</a></span>    <span class="keyword">typedef</span> <a class="code hl_typedef" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a14a1cf543f739e81d992df895873fe34">EquationIdVectorType</a>;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a5bc211023f9e20b6862f19175dfac73d">  132</a></span>    <span class="keyword">typedef</span> <a class="code hl_typedef" href="../../d5/dd4/class_kratos_1_1_element.html#a83ae9b09dd7a0ed7ab3bc1baa6429df5">Element::DofsVectorType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a5bc211023f9e20b6862f19175dfac73d">DofsVectorType</a>;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a101f070f1d8be296f48984c537236a38">  133</a></span>    <span class="keyword">typedef</span> boost::numeric::ublas::compressed_matrix&lt;double&gt; <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a101f070f1d8be296f48984c537236a38">CompressedMatrixType</a>;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab28f7b143a3316b131c8ed154670fc12">  136</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_class" href="../../dc/d58/class_kratos_1_1_dof.html">NodeType::DofType</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab28f7b143a3316b131c8ed154670fc12">DofType</a>;</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a30728020745e1f63faad9e64e2a735ff">  137</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_class" href="../../dc/d58/class_kratos_1_1_dof.html">DofType::Pointer</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a30728020745e1f63faad9e64e2a735ff">DofPointerType</a>;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2bd788b6b620698f7f9799898da92a08">  140</a></span>    <span class="keyword">typedef</span> std::unordered_set&lt;IndexType&gt; <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2bd788b6b620698f7f9799898da92a08">IndexSetType</a>;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6c5edc52cffcb3a5c9a33fa2f1b1a7ac">  143</a></span>    <span class="keyword">typedef</span> std::unordered_map&lt;IndexType, IndexType&gt; <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6c5edc52cffcb3a5c9a33fa2f1b1a7ac">IndexMapType</a>;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a362da1a9096633a8b701a94b97686e83">  146</a></span>    <span class="keyword">typedef</span> <a class="code hl_class" href="../../de/d16/class_kratos_1_1_master_slave_constraint.html">MasterSlaveConstraint</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a362da1a9096633a8b701a94b97686e83">MasterSlaveConstraintType</a>;</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a0d58adcced056c9bd2a1869916701ad2">  147</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> MasterSlaveConstraint::Pointer <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a0d58adcced056c9bd2a1869916701ad2">MasterSlaveConstraintPointerType</a>;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abd6f51d3af05575056ee39c0a92be8ff">  148</a></span>    <span class="keyword">typedef</span> std::vector&lt;IndexType&gt; <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abd6f51d3af05575056ee39c0a92be8ff">VectorIndexType</a>;</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a102418188ba27c6558d32d9811c7d6b2">  149</a></span>    <span class="keyword">typedef</span> <a class="code hl_class" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">Vector</a> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a102418188ba27c6558d32d9811c7d6b2">VectorType</a>;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span> </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a406c25b581ba183f82bd72afedb6339c">  162</a></span>    <span class="keyword">explicit</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a406c25b581ba183f82bd72afedb6339c">ResidualBasedEliminationBuilderAndSolverWithConstraints</a>() : <a class="code hl_class" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html">BaseType</a>()</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    {</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    }</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a05394c1bffbd485c9e7b6c206d1efd75">  169</a></span>    <span class="keyword">explicit</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a05394c1bffbd485c9e7b6c206d1efd75">ResidualBasedEliminationBuilderAndSolverWithConstraints</a>(</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>        <span class="keyword">typename</span> TLinearSolver::Pointer pNewLinearSystemSolver,</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>        <a class="code hl_class" href="../../da/d39/class_parameters.html">Parameters</a> ThisParameters</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        ) : <a class="code hl_class" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html">BaseType</a>(pNewLinearSystemSolver)</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    {</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>        <span class="comment">// Validate and assign defaults</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>        ThisParameters = this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a820ea37407f3fbd75d827ccbfdc0e963">ValidateAndAssignParameters</a>(ThisParameters, this-&gt;<a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab40e00db8fbfa9f3961ae1e47216443d">GetDefaultParameters</a>());</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>        this-&gt;<a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab9c1fb8f6d6ae982b4386bb2e625bd23">AssignSettings</a>(ThisParameters);</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    }</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a67894a891878fdd7e9ae301ab8fb1f6b">  182</a></span>    <span class="keyword">explicit</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a67894a891878fdd7e9ae301ab8fb1f6b">ResidualBasedEliminationBuilderAndSolverWithConstraints</a>(</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>        <span class="keyword">typename</span> TLinearSolver::Pointer pNewLinearSystemSolver,</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> CheckConstraintRelation = <span class="keyword">true</span>,</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> ResetRelationMatrixEachIteration = <span class="keyword">false</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>        )</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>        : <a class="code hl_class" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html">BaseType</a>(pNewLinearSystemSolver),</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>          <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2cb4b9f2b5a37e05e21648ae80a65f52">mCheckConstraintRelation</a>(CheckConstraintRelation),</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>          <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a68a996b72c2d643c49db01f8d5f8cea6">mResetRelationMatrixEachIteration</a>(ResetRelationMatrixEachIteration)</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    {</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    }</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae53685aa212c829c1cf72f4021e46c27">  195</a></span>    <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae53685aa212c829c1cf72f4021e46c27">~ResidualBasedEliminationBuilderAndSolverWithConstraints</a>()<span class="keyword"> override</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    }</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span> </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a9bb2ac99487e72759222b73bffcc7b33">  204</a></span>    <span class="keyword">typename</span> BuilderAndSolverBaseType::Pointer <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a9bb2ac99487e72759222b73bffcc7b33">Create</a>(</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        <span class="keyword">typename</span> TLinearSolver::Pointer pNewLinearSystemSolver,</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        <a class="code hl_class" href="../../da/d39/class_parameters.html">Parameters</a> ThisParameters</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        )<span class="keyword"> const override</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        <span class="keywordflow">return</span> Kratos::make_shared&lt;ClassType&gt;(pNewLinearSystemSolver,ThisParameters);</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    }</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a43743c82a3e85fe4faa9f6a944b04805">  220</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a43743c82a3e85fe4faa9f6a944b04805">SetUpSystem</a>(<a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart)<span class="keyword"> override</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>        <span class="keywordflow">if</span>(rModelPart.MasterSlaveConstraints().size() &gt; 0)</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            SetUpSystemWithConstraints(rModelPart);</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>            <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#af89b687ff19d88b5050236c7afd29daa">BaseType::SetUpSystem</a>(rModelPart);</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    }</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span> </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a0ab5940c81ac46fb3b6f722b21ce4e86">  236</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a0ab5940c81ac46fb3b6f722b21ce4e86">Build</a>(</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>,</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        )<span class="keyword"> override</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        <span class="keywordflow">if</span>(rModelPart.MasterSlaveConstraints().size() &gt; 0)</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>            <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a211319895a1d41183d7f7768223fc3c3">BuildWithConstraints</a>(pScheme, rModelPart, <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rb);</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>            <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a4a6fe7f24463750985fb1e7967892cc6">BaseType::Build</a>(pScheme, rModelPart, <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rb);</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    }</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a0bf04191d0f57789d7b4a2b7560c8159">  259</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a0bf04191d0f57789d7b4a2b7560c8159">BuildAndSolve</a>(</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; A,</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; Dx,</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; b)<span class="keyword"> override</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        <span class="keywordflow">if</span>(rModelPart.MasterSlaveConstraints().size() &gt; 0)</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>            <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#adf73cc405bc18f8d9f2e75ae9acc40db">BuildAndSolveWithConstraints</a>(pScheme, rModelPart, A, Dx, b);</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>            <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a46805f895498d8eb4e85dc8b8d6deb7e">BaseType::BuildAndSolve</a>(pScheme, rModelPart, A, Dx, b);</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    }</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a02834840a6ce4afcbeeb37ab16b34f17">  278</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a02834840a6ce4afcbeeb37ab16b34f17">BuildRHS</a>(</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; b)<span class="keyword"> override</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span> </div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        <span class="keywordflow">if</span>(rModelPart.MasterSlaveConstraints().size() &gt; 0)</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>            <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae3d82886b36bfd00f60b8b8e48d971be">BuildRHSWithConstraints</a>(pScheme, rModelPart, b);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>            <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a367a8cb17bb56e6b5fdc272b40aff1d3">BaseType::BuildRHS</a>(pScheme, rModelPart, b);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span> </div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>    }</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a18f60d6a438dfad5a8353faab17d3391">  302</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a18f60d6a438dfad5a8353faab17d3391">SetUpDofSet</a>(</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        )<span class="keyword"> override</span></div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        <span class="keywordflow">if</span>(rModelPart.MasterSlaveConstraints().size() &gt; 0)</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>            <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ac9503b6d8280e5e7215495d05db12be2">SetUpDofSetWithConstraints</a>(pScheme, rModelPart);</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>            <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a9ecc52fbc0a127e2d771b889af2360b3">BaseType::SetUpDofSet</a>(pScheme, rModelPart);</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    }</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span> </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab40e00db8fbfa9f3961ae1e47216443d">  317</a></span>    <a class="code hl_class" href="../../da/d39/class_parameters.html">Parameters</a> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab40e00db8fbfa9f3961ae1e47216443d">GetDefaultParameters</a>()<span class="keyword"> const override</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <a class="code hl_class" href="../../da/d39/class_parameters.html">Parameters</a> default_parameters = <a class="code hl_class" href="../../da/d39/class_parameters.html">Parameters</a>(R<span class="stringliteral">&quot;(</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span><span class="stringliteral">        {</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span><span class="stringliteral">            &quot;name&quot;                                 : &quot;elimination_builder_and_solver_with_constraints&quot;,</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span><span class="stringliteral">            &quot;check_constraint_relation&quot;            : true,</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span><span class="stringliteral">            &quot;reset_relation_matrix_each_iteration&quot; : true</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span><span class="stringliteral">        })&quot;);</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span><span class="stringliteral">        </span><span class="comment">// Getting base class default parameters</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>        <span class="keyword">const</span> <a class="code hl_class" href="../../da/d39/class_parameters.html">Parameters</a> base_default_parameters = <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a93eda0de27465af0565ff64131eaeece">BaseType::GetDefaultParameters</a>();</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>        default_parameters.RecursivelyAddMissingParameters(base_default_parameters);</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>        <span class="keywordflow">return</span> default_parameters;</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    }</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span> </div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aeb835754600529a2305ce8945a96a24e">  336</a></span>    <span class="keyword">static</span> std::string <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aeb835754600529a2305ce8945a96a24e">Name</a>()</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    {</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;elimination_builder_and_solver_with_constraints&quot;</span>;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    }</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span> </div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aca7c6a916ab458a8bc83a9f26c658a04">  354</a></span>    std::string <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aca7c6a916ab458a8bc83a9f26c658a04">Info</a>()<span class="keyword"> const override</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    }</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span> </div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa1bf3dee15b6ccf2460a3d4862ef4342">  360</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa1bf3dee15b6ccf2460a3d4862ef4342">PrintInfo</a>(std::ostream&amp; rOStream)<span class="keyword"> const override</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        rOStream &lt;&lt; <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aca7c6a916ab458a8bc83a9f26c658a04">Info</a>();</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>    }</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span> </div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#afc1ddf72d10ff9701c8cde25a24c7e46">  366</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#afc1ddf72d10ff9701c8cde25a24c7e46">PrintData</a>(std::ostream&amp; rOStream)<span class="keyword"> const override</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        rOStream &lt;&lt; <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aca7c6a916ab458a8bc83a9f26c658a04">Info</a>();</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    }</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span> </div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span><span class="keyword">protected</span>:</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span> </div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span> </div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">  384</a></span>    <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a27d137182d319891edae86abe9091ee5">TSystemMatrixPointerType</a> <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">mpTMatrix</a> = NULL;             </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a699f63c2cd6ad28f85d4d7887960abfd">  385</a></span>    <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a27d137182d319891edae86abe9091ee5">TSystemMatrixPointerType</a> <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a699f63c2cd6ad28f85d4d7887960abfd">mpOldAMatrix</a> = NULL;          </div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aaad19ea5b5d84c24e3b2b6bb22bb7346">  386</a></span>    <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abbf8fabbf7de8150e696b3fb7804759c">TSystemVectorPointerType</a> <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aaad19ea5b5d84c24e3b2b6bb22bb7346">mpConstantVector</a> = NULL;      </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a89ef3f2d3ae4a2d0e5d65ce96c5810ae">  387</a></span>    <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abbf8fabbf7de8150e696b3fb7804759c">TSystemVectorPointerType</a> <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a89ef3f2d3ae4a2d0e5d65ce96c5810ae">mpDeltaConstantVector</a> = NULL; </div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">  388</a></span>    <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad2ed4c63bee6cb6824710e29e367f145">DofsArrayType</a> <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>;                      </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">  389</a></span>    <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad2ed4c63bee6cb6824710e29e367f145">DofsArrayType</a> <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>;                            </div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">  390</a></span>    <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad57451ea05aecad680fa5936b2cce345">SizeType</a> <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a> = 0;                    </div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab67cb7c7d40bea63853df126c770541d">  391</a></span>    <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6c5edc52cffcb3a5c9a33fa2f1b1a7ac">IndexMapType</a> <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab67cb7c7d40bea63853df126c770541d">mReactionEquationIdMap</a>;                   </div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2cb4b9f2b5a37e05e21648ae80a65f52">  393</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2cb4b9f2b5a37e05e21648ae80a65f52">mCheckConstraintRelation</a> = <span class="keyword">false</span>;                 </div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a68a996b72c2d643c49db01f8d5f8cea6">  394</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a68a996b72c2d643c49db01f8d5f8cea6">mResetRelationMatrixEachIteration</a> = <span class="keyword">false</span>;        </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span> </div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">  396</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a> = <span class="keyword">false</span>;             </div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a428ff44448da78ec23c238b82977375b">  397</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a428ff44448da78ec23c238b82977375b">mCleared</a> = <span class="keyword">true</span>;                                  </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span> </div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a98465de01df1164bd1415d5bf7a4d846">  414</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a98465de01df1164bd1415d5bf7a4d846">AssembleRelationMatrix</a>(</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; rT,</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6aed94fbf245f3cf68d79c5171a68f94">LocalSystemMatrixType</a>&amp; rTransformationMatrix,</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a14a1cf543f739e81d992df895873fe34">EquationIdVectorType</a>&amp; rSlaveEquationId,</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a14a1cf543f739e81d992df895873fe34">EquationIdVectorType</a>&amp; rMasterEquationId</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>        )</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    {</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad57451ea05aecad680fa5936b2cce345">SizeType</a> local_size_1 = rTransformationMatrix.size1();</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span> </div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i_local = 0; i_local &lt; local_size_1; ++i_local) {</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i_global = rSlaveEquationId[i_local];</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span> </div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>            <span class="keywordflow">if</span> (i_global &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>                <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a3f0006d49a686647dc9e7e35e5b1cf85">BaseType::AssembleRowContributionFreeDofs</a>(rT, rTransformationMatrix, i_global, i_local, rMasterEquationId);</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>            }</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>        }</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    }</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span> </div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a236305006a4abafe3176624f9c74d1c3">  438</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a236305006a4abafe3176624f9c74d1c3">ConstructMatrixStructure</a>(</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>,</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>        )<span class="keyword"> override</span></div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>        <span class="keywordflow">if</span>(rModelPart.MasterSlaveConstraints().size() &gt; 0)</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>            <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a981feaa7415d6863fda6c6248a6cebfa">ConstructMatrixStructureWithConstraints</a>(pScheme, <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rModelPart);</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>            <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#ae4fae7e104dd4d490437cbd3ca36667c">BaseType::ConstructMatrixStructure</a>(pScheme, <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rModelPart);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>    }</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span> </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#adf73cc405bc18f8d9f2e75ae9acc40db">  458</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#adf73cc405bc18f8d9f2e75ae9acc40db">BuildAndSolveWithConstraints</a>(</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>,</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rDx,</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>        )</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    {</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span> </div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>        Timer::Start(<span class="stringliteral">&quot;Build&quot;</span>);</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span> </div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>        <span class="comment">// We apply the master/slave relationship before build</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>        ApplyMasterSlaveRelation(pScheme, rModelPart, <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rDx, rb);</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>        <span class="comment">// We compute the effective constant vector</span></div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a> dummy_Dx(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>);</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>        TSparseSpace::SetToZero(dummy_Dx);</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        ComputeEffectiveConstant(pScheme, rModelPart, dummy_Dx);</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span> </div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        <span class="comment">// We do the build (after that we resize the solution vector to avoid problems)</span></div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>        <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a211319895a1d41183d7f7768223fc3c3">BuildWithConstraints</a>(pScheme, rModelPart, <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rb);</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>        Timer::Stop(<span class="stringliteral">&quot;Build&quot;</span>);</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>        <span class="comment">// Now we apply the BC</span></div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>        rDx.<a class="code hl_function" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html#a3d36c583d63e7eeda493a7abdc97d874">resize</a>(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>        <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a3ef8d55c96702d9cb9d13724070c3b97">ApplyDirichletConditions</a>(pScheme, rModelPart, <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rDx, rb);</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span> </div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, (this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() == 3)) &lt;&lt;</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        <span class="stringliteral">&quot;Before the solution of the system&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\nSystem Matrix = &quot;</span> &lt;&lt; rA &lt;&lt; <span class="stringliteral">&quot;\nUnknowns vector = &quot;</span> &lt;&lt; rDx &lt;&lt; <span class="stringliteral">&quot;\nRHS vector = &quot;</span> &lt;&lt; rb &lt;&lt; std::endl;</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span> </div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>        <span class="comment">// We solve the system of equations</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_namespace" href="../../d5/d83/namespacetimer.html">timer</a> = <a class="code hl_class" href="../../d3/d5a/class_kratos_1_1_builtin_timer.html">BuiltinTimer</a>();</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> start_solve = <a class="code hl_namespace" href="../../d5/d83/namespacetimer.html">timer</a>.ElapsedSeconds();</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>        Timer::Start(<span class="stringliteral">&quot;Solve&quot;</span>);</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>        <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6b456ab531be4a6fa894797833b144f7">SystemSolveWithPhysics</a>(<a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rDx, rb, rModelPart);</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span> </div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>        Timer::Stop(<span class="stringliteral">&quot;Solve&quot;</span>);</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> stop_solve = <a class="code hl_namespace" href="../../d5/d83/namespacetimer.html">timer</a>.ElapsedSeconds();</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> </div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>        <span class="comment">// We compute the effective constant vector</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>        ComputeEffectiveConstant(pScheme, rModelPart, rDx);</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span> </div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>        <span class="comment">// We reconstruct the Unknowns vector and the residual</span></div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> start_reconstruct_slaves = <a class="code hl_namespace" href="../../d5/d83/namespacetimer.html">timer</a>.ElapsedSeconds();</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>        ReconstructSlaveSolutionAfterSolve(pScheme, rModelPart, <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rDx, rb);</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span> </div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> stop_reconstruct_slaves = <a class="code hl_namespace" href="../../d5/d83/namespacetimer.html">timer</a>.ElapsedSeconds();</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, (this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt;= 1 &amp;&amp; rModelPart.GetCommunicator().MyPID() == 0)) &lt;&lt; <span class="stringliteral">&quot;Reconstruct slaves time: &quot;</span> &lt;&lt; stop_reconstruct_slaves - start_reconstruct_slaves &lt;&lt; std::endl;</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span> </div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>        <span class="comment">// Some verbosity</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, (this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt;= 1 &amp;&amp; rModelPart.GetCommunicator().MyPID() == 0)) &lt;&lt; <span class="stringliteral">&quot;System solve time: &quot;</span> &lt;&lt; stop_solve - start_solve &lt;&lt; std::endl;</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, (this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() == 3)) &lt;&lt;</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>        <span class="stringliteral">&quot;After the solution of the system&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\nSystem Matrix = &quot;</span> &lt;&lt; rA &lt;&lt; <span class="stringliteral">&quot;\nUnknowns vector = &quot;</span> &lt;&lt; rDx &lt;&lt; <span class="stringliteral">&quot;\nRHS vector = &quot;</span> &lt;&lt; rb &lt;&lt; std::endl;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span> </div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>    }</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae3d82886b36bfd00f60b8b8e48d971be">  524</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae3d82886b36bfd00f60b8b8e48d971be">BuildRHSWithConstraints</a>(</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>        )</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    {</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>        Timer::Start(<span class="stringliteral">&quot;Build RHS&quot;</span>);</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span> </div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>        <span class="comment">// Resetting to zero the vector of reactions</span></div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#adf722c4e501d8e245fc554bd97beab1d">BaseType::mCalculateReactionsFlag</a>) {</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>            TSparseSpace::SetToZero(*(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a77fcbfce08aab91bcb13400df7b1d401">BaseType::mpReactionsVector</a>));</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>        }</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span> </div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>        <span class="comment">// Builing without BC</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>        <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2d1139b0c2844483362d84110491c7e8">BuildRHSNoDirichlet</a>(pScheme,rModelPart,rb);</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span> </div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        Timer::Stop(<span class="stringliteral">&quot;Build RHS&quot;</span>);</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        ApplyDirichletConditionsRHS(pScheme, rModelPart, rb);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>        <span class="comment">// We get the global T matrix</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; rTMatrix = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">mpTMatrix</a>;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        <span class="comment">// Reconstruct the RHS</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a> rb_copy = rb;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>        rb.resize(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>        TSparseSpace::Mult(rTMatrix, rb_copy, rb);</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span> </div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        <span class="comment">// Adding contribution to reactions</span></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; r_reactions_vector = *<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a77fcbfce08aab91bcb13400df7b1d401">BaseType::mpReactionsVector</a>;</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span> </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#adf722c4e501d8e245fc554bd97beab1d">BaseType::mCalculateReactionsFlag</a>) {</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; r_dof : <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>) {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>                <span class="keyword">const</span> <span class="keywordtype">bool</span> is_master_fixed = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.find(r_dof) == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.end() ? false : <span class="keyword">true</span>;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>                <span class="keyword">const</span> <span class="keywordtype">bool</span> is_slave = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.find(r_dof) == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.end() ? false : <span class="keyword">true</span>;</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>                <span class="keywordflow">if</span> (is_master_fixed || is_slave) { <span class="comment">// Fixed or MPC dof</span></div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> equation_id = r_dof.EquationId();</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>                    r_reactions_vector[<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab67cb7c7d40bea63853df126c770541d">mReactionEquationIdMap</a>[equation_id]] += rb[equation_id];</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>                }</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>            }</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>        }</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span> </div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>        <span class="comment">// Some verbosity</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, (this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() == 3)) &lt;&lt;</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>        <span class="stringliteral">&quot;After the solution of the system&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\nRHS vector = &quot;</span> &lt;&lt; rb &lt;&lt; std::endl;</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    }</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ac9503b6d8280e5e7215495d05db12be2">  577</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ac9503b6d8280e5e7215495d05db12be2">SetUpDofSetWithConstraints</a>(</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        )</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>    {</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a>;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span> </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, ( this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 1 &amp;&amp; rModelPart.GetCommunicator().MyPID() == 0)) &lt;&lt; <span class="stringliteral">&quot;Setting up the dofs&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span> </div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a5bc211023f9e20b6862f19175dfac73d">DofsVectorType</a> dof_list, second_dof_list; <span class="comment">// NOTE: The second dof list is only used on constraints to include master/slave relations</span></div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span> </div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        <span class="keyword">typedef</span> std::unordered_set &lt; DofPointerType, DofPointerHasher&gt; set_type;</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span> </div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>        <span class="comment">// Declaring temporal variables</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad2ed4c63bee6cb6824710e29e367f145">DofsArrayType</a> dof_temp_all, dof_temp_solvable, dof_temp_slave;</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span> </div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>        <span class="comment">// We assign an empty dof array to our dof sets</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>        <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a> = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad2ed4c63bee6cb6824710e29e367f145">DofsArrayType</a>(); </div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>        <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a> = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad2ed4c63bee6cb6824710e29e367f145">DofsArrayType</a>();    </div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span> </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>        set_type dof_global_set, dof_global_slave_set;</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span> </div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span><span class="preprocessor">        #pragma omp parallel firstprivate(dof_list, second_dof_list)</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>        {</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>            <span class="keyword">const</span> <a class="code hl_enumvalue" href="../../db/d66/namespace_kratos.html#a1514eea722d243fa5561f7050c071b9fa72b048930550a0e11889dd0ac17b0439">ProcessInfo</a>&amp; r_current_process_info = rModelPart.GetProcessInfo();</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span> </div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>            <span class="comment">// We cleate the temporal set and we reserve some space on them</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>            set_type dofs_tmp_set, dof_temp_slave_set;</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>            dofs_tmp_set.reserve(20000);</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>            dof_temp_slave_set.reserve(200);</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span> </div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>            <span class="comment">// Gets the array of elements from the modeler</span></div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a4757f6a4bfb8f4a10b2c6d5a8c55d907">ElementsArrayType</a>&amp; r_elements_array = rModelPart.Elements();</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> number_of_elements = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(r_elements_array.size());</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span><span class="preprocessor">            #pragma omp for schedule(guided, 512) nowait</span></div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; number_of_elements; ++i) {</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>                <span class="keyword">auto</span> it_elem = r_elements_array.begin() + i;</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span> </div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>                <span class="comment">// Gets list of Dof involved on every element</span></div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>                pScheme-&gt;GetDofList(*it_elem, dof_list, r_current_process_info);</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>                dofs_tmp_set.insert(dof_list.begin(), dof_list.end());</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>            }</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span> </div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>            <span class="comment">// Gets the array of conditions from the modeler</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a45cc985b9e9eb40ed8337f0c70f29cbe">ConditionsArrayType</a>&amp; r_conditions_array = rModelPart.Conditions();</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> number_of_conditions = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(r_conditions_array.size());</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span><span class="preprocessor">            #pragma omp for  schedule(guided, 512) nowait</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; number_of_conditions; ++i) {</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>                <span class="keyword">auto</span> it_cond = r_conditions_array.begin() + i;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span> </div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>                <span class="comment">// Gets list of Dof involved on every element</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>                pScheme-&gt;GetDofList(*it_cond, dof_list, r_current_process_info);</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>                dofs_tmp_set.insert(dof_list.begin(), dof_list.end());</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>            }</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span> </div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>            <span class="comment">// Gets the array of constraints from the modeler</span></div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>            <span class="keyword">auto</span>&amp; r_constraints_array = rModelPart.MasterSlaveConstraints();</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> number_of_constraints = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(r_constraints_array.size());</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span><span class="preprocessor">            #pragma omp for  schedule(guided, 512) nowait</span></div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; number_of_constraints; ++i) {</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>                <span class="keyword">auto</span> it_const = r_constraints_array.begin() + i;</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span> </div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>                <span class="comment">// Gets list of Dof involved on every element</span></div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>                it_const-&gt;GetDofList(dof_list, second_dof_list, r_current_process_info);</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>                dofs_tmp_set.insert(dof_list.begin(), dof_list.end());</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>                dofs_tmp_set.insert(second_dof_list.begin(), second_dof_list.end());</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>                dof_temp_slave_set.insert(dof_list.begin(), dof_list.end());</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>            }</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span> </div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>            <span class="comment">// We merge all the sets in one thread</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span><span class="preprocessor">            #pragma omp critical</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>            {</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>                dof_global_set.insert(dofs_tmp_set.begin(), dofs_tmp_set.end());</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>                dof_global_slave_set.insert(dof_temp_slave_set.begin(), dof_temp_slave_set.end());</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>            }</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>        }</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span> </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, ( this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 2)) &lt;&lt; <span class="stringliteral">&quot;Initializing ordered array filling\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span> </div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        dof_temp_all.reserve(dof_global_set.size());</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> p_dof : dof_global_set) {</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>            dof_temp_all.push_back( p_dof );</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>        }</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>        dof_temp_all.Sort();</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>        <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a> = dof_temp_all;</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span> </div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>        dof_temp_slave.reserve(dof_global_slave_set.size());</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> p_dof : dof_global_slave_set) {</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>            dof_temp_slave.push_back( p_dof );</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>        }</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>        dof_temp_slave.Sort();</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>        <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a> = dof_temp_slave;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span> </div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>        <span class="comment">// Throws an exception if there are no Degrees Of Freedom involved in the analysis</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>        <a class="code hl_define" href="../../d5/d4d/group___kratos_core.html#ga9fdd4e0364598f28a529107663707cf3">KRATOS_ERROR_IF</a>(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.size() == 0) &lt;&lt; <span class="stringliteral">&quot;No degrees of freedom!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#af0e287de83134e4e7461c80c5395be73">KRATOS_WARNING_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.size() == 0) &lt;&lt; <span class="stringliteral">&quot;No slave degrees of freedom to solve!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span> </div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, ( this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 2)) &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom:&quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.size() &lt;&lt; std::endl;</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span> </div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>        <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a22231ac6816fd743908f9601bd8ba6a5">BaseType::mDofSetIsInitialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span> </div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, ( this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 2 &amp;&amp; rModelPart.GetCommunicator().MyPID() == 0)) &lt;&lt; <span class="stringliteral">&quot;Finished setting up the dofs&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span> </div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span><span class="preprocessor">#ifdef USE_LOCKS_IN_ASSEMBLY</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, ( this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 2)) &lt;&lt; <span class="stringliteral">&quot;Initializing lock array&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span> </div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>        <span class="keywordflow">if</span> (BaseType::mLockArray.size() != 0) {</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; static_cast&lt;int&gt;(BaseType::mLockArray.size()); ++i) {</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>                omp_destroy_lock(&amp;BaseType::mLockArray[i]);</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>            }</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>        }</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>        BaseType::mLockArray.resize(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.size());</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span> </div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; static_cast&lt;int&gt;(BaseType::mLockArray.size()); ++i) {</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>            omp_init_lock(&amp;BaseType::mLockArray[i]);</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>        }</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span> </div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, ( this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 2)) &lt;&lt; <span class="stringliteral">&quot;End of setup dof set\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span> </div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    <span class="comment">// If reactions are to be calculated, we check if all the dofs have reactions defined</span></div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>    <span class="comment">// This is tobe done only in debug mode</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span><span class="preprocessor">    #ifdef KRATOS_DEBUG</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4960cb64a0657894f9776608a923ce25">BaseType::GetCalculateReactionsFlag</a>()) {</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span> dof_iterator = <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.begin(); dof_iterator != <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.end(); ++dof_iterator) {</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>                <a class="code hl_define" href="../../d5/d4d/group___kratos_core.html#ga421c079910a05f8a88688b045190ac9b">KRATOS_ERROR_IF_NOT</a>(dof_iterator-&gt;HasReaction()) &lt;&lt; <span class="stringliteral">&quot;Reaction variable not set for the following : &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>                    &lt;&lt; <span class="stringliteral">&quot;Node : &quot;</span> &lt;&lt; dof_iterator-&gt;Id() &lt;&lt; std::endl</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>                    &lt;&lt; <span class="stringliteral">&quot;Dof : &quot;</span> &lt;&lt; (*dof_iterator) &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Not possible to calculate reactions.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>            }</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>        }</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span><span class="preprocessor">    #endif</span></div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span> </div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>    }</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span> </div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6b456ab531be4a6fa894797833b144f7">  725</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6b456ab531be4a6fa894797833b144f7">SystemSolveWithPhysics</a>(</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>,</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rDx,</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb,</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>        )</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    {</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span> </div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>        <span class="keywordtype">double</span> norm_b = 0.0;</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>        <span class="keywordflow">if</span> (TSparseSpace::Size(rb) &gt; 0)</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>            norm_b = TSparseSpace::TwoNorm(rb);</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span> </div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>        <span class="keywordflow">if</span> (norm_b &gt; 0.0) {</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>             <span class="comment">// Create the auxiliar dof set</span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>             <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad2ed4c63bee6cb6824710e29e367f145">DofsArrayType</a> aux_dof_set;</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>             aux_dof_set.reserve(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>);</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>             <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; r_dof : <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>) {</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>                 <span class="keywordflow">if</span> (r_dof.EquationId() &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>                    <span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.find(r_dof);</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>                    <span class="keywordflow">if</span> (it == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.end())</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>                        aux_dof_set.push_back( &amp;r_dof );</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>                 }</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>             }</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>             aux_dof_set.Sort();</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span> </div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>             <a class="code hl_define" href="../../d5/d4d/group___kratos_core.html#ga421c079910a05f8a88688b045190ac9b">KRATOS_ERROR_IF_NOT</a>(aux_dof_set.size() == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>) &lt;&lt; <span class="stringliteral">&quot;Inconsistency (I) in system size: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a> &lt;&lt; <span class="stringliteral">&quot; vs &quot;</span> &lt;&lt; aux_dof_set.size() &lt;&lt; <span class="stringliteral">&quot;\n Size dof set &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.size() &lt;&lt; <span class="stringliteral">&quot; vs Size slave dof set &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.size() &lt;&lt; std::endl;</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>             <a class="code hl_define" href="../../d5/d4d/group___kratos_core.html#ga421c079910a05f8a88688b045190ac9b">KRATOS_ERROR_IF_NOT</a>(aux_dof_set.size() == <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>.size1()) &lt;&lt; <span class="stringliteral">&quot;Inconsistency (II) in system size: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>.size1() &lt;&lt; <span class="stringliteral">&quot; vs &quot;</span> &lt;&lt; aux_dof_set.size() &lt;&lt; <span class="stringliteral">&quot;\n Size dof set &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.size() &lt;&lt; <span class="stringliteral">&quot; vs Size slave dof set &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.size() &lt;&lt; std::endl;</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span> </div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>            <span class="comment">// Provide physical data as needed</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab506043e71e90f54eb7ea575db79550a">BaseType::mpLinearSystemSolver</a>-&gt;AdditionalPhysicalDataIsNeeded())</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>                <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab506043e71e90f54eb7ea575db79550a">BaseType::mpLinearSystemSolver</a>-&gt;ProvideAdditionalData(<a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rDx, rb, aux_dof_set, rModelPart);</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span> </div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>            <span class="comment">// Do solve</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>            <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab506043e71e90f54eb7ea575db79550a">BaseType::mpLinearSystemSolver</a>-&gt;Solve(<a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rDx, rb);</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>            TSparseSpace::SetToZero(rDx);</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>            <a class="code hl_define" href="../../d1/d8c/logger_8h.html#af0e287de83134e4e7461c80c5395be73">KRATOS_WARNING_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolver&quot;</span>, rModelPart.GetCommunicator().MyPID() == 0) &lt;&lt; <span class="stringliteral">&quot;ATTENTION! setting the RHS to zero!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>        }</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span> </div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>        <span class="comment">// Prints information about the current time</span></div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolver&quot;</span>, this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 1 &amp;&amp; rModelPart.GetCommunicator().MyPID() == 0) &lt;&lt; *(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab506043e71e90f54eb7ea575db79550a">BaseType::mpLinearSystemSolver</a>) &lt;&lt; std::endl;</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span> </div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span> </div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>    }</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span> </div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a981feaa7415d6863fda6c6248a6cebfa">  777</a></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a981feaa7415d6863fda6c6248a6cebfa">ConstructMatrixStructureWithConstraints</a>(</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>,</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>        )</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>    {</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>        <span class="comment">// Filling with zero the matrix (creating the structure)</span></div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>        Timer::Start(<span class="stringliteral">&quot;MatrixStructure&quot;</span>);</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span> </div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>        <span class="comment">// The total number of dof of the system</span></div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad57451ea05aecad680fa5936b2cce345">SizeType</a> equation_size = <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>;</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span> </div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>        <span class="comment">// This vector contains the indexes sets for all rows</span></div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>        std::vector&lt;IndexSetType&gt; indices(equation_size);</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span> </div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>        <span class="comment">// We reserve some indexes on each row</span></div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>        <a class="code hl_function" href="../../db/d66/namespace_kratos.html#a07ef8a5b8886ded903a1e7ad4c0df960">block_for_each</a>(indices, [](<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2bd788b6b620698f7f9799898da92a08">IndexSetType</a>&amp; rIndices){</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>            rIndices.reserve(40);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>        });</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span> </div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a14a1cf543f739e81d992df895873fe34">EquationIdVectorType</a> ids(3, 0);</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a14a1cf543f739e81d992df895873fe34">EquationIdVectorType</a> second_ids(3, 0); <span class="comment">// NOTE: Used only on the constraints to take into account the master dofs</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span> </div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span><span class="preprocessor">        #pragma omp parallel firstprivate(ids, second_ids)</span></div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>        {</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>            <span class="comment">// The process info</span></div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>            <span class="keyword">const</span> <a class="code hl_enumvalue" href="../../db/d66/namespace_kratos.html#a1514eea722d243fa5561f7050c071b9fa72b048930550a0e11889dd0ac17b0439">ProcessInfo</a>&amp; r_current_process_info = rModelPart.GetProcessInfo();</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span> </div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>            <span class="comment">// We repeat the same declaration for each thead</span></div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>            std::vector&lt;IndexSetType&gt; temp_indexes(equation_size);</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span> </div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span><span class="preprocessor">            #pragma omp for</span></div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> index = 0; index &lt; static_cast&lt;int&gt;(equation_size); ++index)</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>                temp_indexes[index].reserve(30);</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span> </div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>            <span class="comment">// Getting the size of the array of elements from the model</span></div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> number_of_elements = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(rModelPart.Elements().size());</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span> </div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>            <span class="comment">// Element initial iterator</span></div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>            <span class="keyword">const</span> <span class="keyword">auto</span> el_begin = rModelPart.ElementsBegin();</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span> </div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>            <span class="comment">// We iterate over the elements</span></div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span><span class="preprocessor">            #pragma omp for schedule(guided, 512) nowait</span></div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_elem = 0; i_elem&lt;number_of_elements; ++i_elem) {</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>                <span class="keyword">auto</span> it_elem = el_begin + i_elem;</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>                pScheme-&gt;EquationId(*it_elem, ids, r_current_process_info);</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span> </div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; id_i : ids) {</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>                    <span class="keywordflow">if</span> (id_i &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>                        <span class="keyword">auto</span>&amp; row_indices = temp_indexes[id_i];</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; id_j : ids) {</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>                            <span class="keywordflow">if</span> (id_j &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>                                row_indices.insert(id_j);</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>                            }</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>                        }</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>                    }</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>                }</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>            }</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span> </div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>            <span class="comment">// Getting the size of the array of the conditions</span></div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> number_of_conditions = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(rModelPart.Conditions().size());</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span> </div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>            <span class="comment">// Condition initial iterator</span></div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>            <span class="keyword">const</span> <span class="keyword">auto</span> cond_begin = rModelPart.ConditionsBegin();</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span> </div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>            <span class="comment">// We iterate over the conditions</span></div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span><span class="preprocessor">            #pragma omp for schedule(guided, 512) nowait</span></div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_cond = 0; i_cond&lt;number_of_conditions; ++i_cond) {</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>                <span class="keyword">auto</span> it_cond = cond_begin + i_cond;</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>                pScheme-&gt;EquationId(*it_cond, ids, r_current_process_info);</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; id_i : ids) {</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>                    <span class="keywordflow">if</span> (id_i &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>                        <span class="keyword">auto</span>&amp; row_indices = temp_indexes[id_i];</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; id_j : ids) {</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>                            <span class="keywordflow">if</span> (id_j &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>                                row_indices.insert(id_j);</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>                            }</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>                        }</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>                    }</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>                }</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>            }</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span> </div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>            <span class="comment">// Getting the size of the array of the constraints</span></div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> number_of_constraints = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(rModelPart.MasterSlaveConstraints().size());</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span> </div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>            <span class="comment">// Constraint initial iterator</span></div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>            <span class="keyword">const</span> <span class="keyword">auto</span> const_begin = rModelPart.MasterSlaveConstraints().begin();</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span> </div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>            <span class="comment">// We iterate over the constraints</span></div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span><span class="preprocessor">            #pragma omp for schedule(guided, 512) nowait</span></div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_const = 0; i_const &lt; number_of_constraints; ++i_const) {</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>                <span class="keyword">auto</span> it_const = const_begin + i_const;</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span> </div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>                <span class="comment">// Detect if the constraint is active or not. If the user did not make any choice the constraint</span></div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>                <span class="comment">// It is active by default</span></div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>                <span class="keywordtype">bool</span> constraint_is_active = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>                <span class="keywordflow">if</span>( it_const-&gt;IsDefined(ACTIVE) ) {</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>                    constraint_is_active = it_const-&gt;Is(ACTIVE);</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>                }</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span> </div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>                <span class="keywordflow">if</span>(constraint_is_active) {</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>                    it_const-&gt;EquationIdVector(ids, second_ids, r_current_process_info);</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>                    <span class="comment">// Slave DoFs</span></div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; id_i : ids) {</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>                        <span class="keywordflow">if</span> (id_i &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>                            <span class="keyword">auto</span>&amp; row_indices = temp_indexes[id_i];</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>                            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; id_j : ids) {</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>                                <span class="keywordflow">if</span> (id_j &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>                                    row_indices.insert(id_j);</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>                                }</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>                            }</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>                        }</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>                    }</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>                    <span class="comment">// Master DoFs</span></div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; id_i : second_ids) {</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>                        <span class="keywordflow">if</span> (id_i &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>                            <span class="keyword">auto</span>&amp; row_indices = temp_indexes[id_i];</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>                            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; id_j : second_ids) {</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>                                <span class="keywordflow">if</span> (id_j &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>                                    row_indices.insert(id_j);</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>                                }</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>                            }</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>                        }</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>                    }</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>                }</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>            }</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span> </div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>            <span class="comment">// Merging all the temporal indexes</span></div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span><span class="preprocessor">            #pragma omp critical</span></div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>            {</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; static_cast&lt;int&gt;(temp_indexes.size()); ++i) {</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>                    indices[i].insert(temp_indexes[i].begin(), temp_indexes[i].end());</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>                }</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>            }</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>        }</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span> </div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>        <span class="comment">// Count the row sizes</span></div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad57451ea05aecad680fa5936b2cce345">SizeType</a> nnz = 0;</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i = 0; i &lt; indices.size(); ++i)</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>            nnz += indices[i].size();</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span> </div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>        <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a> = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a101f070f1d8be296f48984c537236a38">CompressedMatrixType</a>(indices.size(), indices.size(), nnz);</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span> </div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>        <span class="keywordtype">double</span> *Avalues = <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>.value_data().begin();</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> *Arow_indices = <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>.index1_data().begin();</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> *Acol_indices = <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>.index2_data().begin();</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span> </div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>        <span class="comment">// Filling the index1 vector - DO NOT MAKE PARALLEL THE FOLLOWING LOOP!</span></div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>        Arow_indices[0] = 0;</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; static_cast&lt;int&gt;(<a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>.size1()); i++)</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>            Arow_indices[i + 1] = Arow_indices[i] + indices[i].size();</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span> </div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>        <a class="code hl_class" href="../../d9/d9b/class_kratos_1_1_index_partition.html">IndexPartition&lt;std::size_t&gt;</a>(<a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>.size1()).<a class="code hl_function" href="../../d9/d9b/class_kratos_1_1_index_partition.html#af1ce67064923939c2a8a0172cdb5e344">for_each</a>([&amp;](std::size_t Index){</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> row_begin = Arow_indices[Index];</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> row_end = Arow_indices[Index + 1];</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> k = row_begin;</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = indices[Index].begin(); it != indices[Index].end(); ++it) {</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>                Acol_indices[k] = *it;</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>                Avalues[k] = 0.0;</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>                k++;</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>            }</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span> </div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>            indices[Index].clear(); <span class="comment">//deallocating the memory</span></div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span> </div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>            std::sort(&amp;Acol_indices[row_begin], &amp;Acol_indices[row_end]);</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>        });</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span> </div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>        <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>.set_filled(indices.size() + 1, nnz);</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span> </div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>        Timer::Stop(<span class="stringliteral">&quot;MatrixStructure&quot;</span>);</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>    }</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span> </div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab96c33010353414ca9fe9938d3705e64">  956</a></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab96c33010353414ca9fe9938d3705e64">ConstructRelationMatrixStructure</a>(</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; rT,</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>        )</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>    {</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>        <span class="comment">// Filling with zero the matrix (creating the structure)</span></div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>        Timer::Start(<span class="stringliteral">&quot;RelationMatrixStructure&quot;</span>);</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span> </div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6c5edc52cffcb3a5c9a33fa2f1b1a7ac">IndexMapType</a> solvable_dof_reorder;</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>        std::unordered_map&lt;IndexType, IndexSetType&gt; master_indices;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span> </div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>        <span class="comment">// Filling with &quot;ones&quot;</span></div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>        <span class="keyword">typedef</span> std::pair&lt;IndexType, IndexType&gt; IndexIndexPairType;</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>        <span class="keyword">typedef</span> std::pair&lt;IndexType, IndexSetType&gt; IndexIndexSetPairType;</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> counter = 0;</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; dof : <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>) {</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>            <span class="keywordflow">if</span> (dof.EquationId() &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> equation_id = dof.EquationId();</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>                <span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.find(dof);</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>                <span class="keywordflow">if</span> (it == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.end()) {</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>                    solvable_dof_reorder.insert(IndexIndexPairType(equation_id, counter));</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>                    master_indices.insert(IndexIndexSetPairType(equation_id, <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2bd788b6b620698f7f9799898da92a08">IndexSetType</a>({counter})));</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>                    ++counter;</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>                    master_indices.insert(IndexIndexSetPairType(equation_id, <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2bd788b6b620698f7f9799898da92a08">IndexSetType</a>({})));</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>                }</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>            }</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>        }</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span> </div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>        <span class="comment">// The process info</span></div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>        <span class="keyword">const</span> <a class="code hl_enumvalue" href="../../db/d66/namespace_kratos.html#a1514eea722d243fa5561f7050c071b9fa72b048930550a0e11889dd0ac17b0439">ProcessInfo</a>&amp; r_current_process_info = rModelPart.GetProcessInfo();</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span> </div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a14a1cf543f739e81d992df895873fe34">EquationIdVectorType</a> ids(3, 0);</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a14a1cf543f739e81d992df895873fe34">EquationIdVectorType</a> second_ids(3, 0); <span class="comment">// NOTE: Used only on the constraints to take into account the master dofs</span></div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span> </div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> number_of_constraints = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(rModelPart.MasterSlaveConstraints().size());</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>        <span class="keyword">const</span> <span class="keyword">auto</span> it_const_begin = rModelPart.MasterSlaveConstraints().begin();</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>        <span class="comment">// TODO: OMP</span></div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_const = 0; i_const &lt; number_of_constraints; ++i_const) {</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>            <span class="keyword">auto</span> it_const = it_const_begin + i_const;</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span> </div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>            <span class="comment">// Detect if the constraint is active or not. If the user did not make any choice the constraint</span></div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>            <span class="comment">// It is active by default</span></div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>            <span class="keywordtype">bool</span> constraint_is_active = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>            <span class="keywordflow">if</span>( it_const-&gt;IsDefined(ACTIVE) ) {</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>                constraint_is_active = it_const-&gt;Is(ACTIVE);</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>            }</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span> </div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>            <span class="keywordflow">if</span>(constraint_is_active) {</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>                it_const-&gt;EquationIdVector(ids, second_ids, r_current_process_info);</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; slave_id : ids) {</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>                    <span class="keywordflow">if</span> (slave_id &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>                        <span class="keyword">auto</span> it_slave = solvable_dof_reorder.find(slave_id);</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>                        <span class="keywordflow">if</span> (it_slave == solvable_dof_reorder.end()) {</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>                            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; master_id : second_ids) {</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>                                <span class="keywordflow">if</span> (master_id &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>                                    <span class="keyword">auto</span>&amp; master_row_indices = master_indices[slave_id];</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>                                    master_row_indices.insert(solvable_dof_reorder[master_id]);</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>                                }</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>                            }</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>                        }</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>                    }</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>                }</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>            }</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>        }</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span> </div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>        <a class="code hl_define" href="../../d5/d4d/group___kratos_core.html#gaf4e978eeb9eea72104d5740bba04411f">KRATOS_DEBUG_ERROR_IF_NOT</a>(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a> == master_indices.size()) &lt;&lt; <span class="stringliteral">&quot;Inconsistency in the dofs size: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a> &lt;&lt; <span class="stringliteral">&quot;\t vs \t&quot;</span> &lt;&lt; master_indices.size() &lt;&lt; std::endl;</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span> </div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>        <span class="comment">// Count the row sizes</span></div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad57451ea05aecad680fa5936b2cce345">SizeType</a> nnz = 0;</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i = 0; i &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>; ++i) {</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>            nnz += master_indices[i].size();</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>        }</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span> </div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>        rT = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a101f070f1d8be296f48984c537236a38">CompressedMatrixType</a>(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>, nnz);</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span> </div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>        <span class="keywordtype">double</span> *Tvalues = rT.value_data().begin();</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> *Trow_indices = rT.index1_data().begin();</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> *Tcol_indices = rT.index2_data().begin();</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span> </div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>        <span class="comment">// Filling the index1 vector - DO NOT MAKE PARALLEL THE FOLLOWING LOOP!</span></div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>        Trow_indices[0] = 0;</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i = 0; i &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>; ++i)</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>            Trow_indices[i + 1] = Trow_indices[i] + master_indices[i].size();</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span> </div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>        <a class="code hl_define" href="../../d5/d4d/group___kratos_core.html#gaf4e978eeb9eea72104d5740bba04411f">KRATOS_DEBUG_ERROR_IF_NOT</a>(Trow_indices[<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>] == nnz) &lt;&lt; <span class="stringliteral">&quot;Nonzero values does not coincide with the row index definition: &quot;</span> &lt;&lt; Trow_indices[<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>] &lt;&lt; <span class="stringliteral">&quot; vs &quot;</span> &lt;&lt; nnz &lt;&lt; std::endl;</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span> </div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>        <a class="code hl_class" href="../../d9/d9b/class_kratos_1_1_index_partition.html">IndexPartition&lt;std::size_t&gt;</a>(rT.size1()).<a class="code hl_function" href="../../d9/d9b/class_kratos_1_1_index_partition.html#af1ce67064923939c2a8a0172cdb5e344">for_each</a>([&amp;](std::size_t Index){</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> row_begin = Trow_indices[Index];</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> row_end = Trow_indices[Index + 1];</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> k = row_begin;</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = master_indices[Index].begin(); it != master_indices[Index].end(); ++it) {</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>                Tcol_indices[k] = *it;</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>                Tvalues[k] = 0.0;</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>                k++;</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>            }</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span> </div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>            master_indices[Index].clear(); <span class="comment">//deallocating the memory</span></div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span> </div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>            std::sort(&amp;Tcol_indices[row_begin], &amp;Tcol_indices[row_end]);</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>        });</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>        rT.set_filled(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a> + 1, nnz);</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span> </div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>        <span class="comment">// Setting ones</span></div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; solv_dof : solvable_dof_reorder) {</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>            rT(solv_dof.first, solv_dof.second) = 1.0;</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>        }</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span> </div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>        Timer::Stop(<span class="stringliteral">&quot;RelationMatrixStructure&quot;</span>);</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>    }</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span> </div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a211319895a1d41183d7f7768223fc3c3"> 1078</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a211319895a1d41183d7f7768223fc3c3">BuildWithConstraints</a>(</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>,</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb,</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> UseBaseBuild = <span class="keyword">true</span></div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>        )</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>    {</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span> </div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>        <span class="comment">// We build the original system</span></div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>        <span class="keywordflow">if</span> (UseBaseBuild)</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>            <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a4a6fe7f24463750985fb1e7967892cc6">BaseType::Build</a>(pScheme, rModelPart, <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rb);</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>            BuildWithoutConstraints(pScheme, rModelPart, <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rb);</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span> </div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>        <span class="comment">// Assemble the constraints</span></div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_namespace" href="../../d5/d83/namespacetimer.html">timer</a> = <a class="code hl_class" href="../../d3/d5a/class_kratos_1_1_builtin_timer.html">BuiltinTimer</a>();</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span> </div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>        <span class="comment">// We get the global T matrix</span></div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; rTMatrix = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">mpTMatrix</a>;</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span> </div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>        <span class="comment">// We compute only once (or if cleared)</span></div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a428ff44448da78ec23c238b82977375b">mCleared</a>) {</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>            <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a428ff44448da78ec23c238b82977375b">mCleared</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>            ComputeConstraintContribution(pScheme, rModelPart, <span class="keyword">true</span>, <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a>);</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a68a996b72c2d643c49db01f8d5f8cea6">mResetRelationMatrixEachIteration</a>) {</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>            ResetConstraintSystem();</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>            ComputeConstraintContribution(pScheme, rModelPart, <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a68a996b72c2d643c49db01f8d5f8cea6">mResetRelationMatrixEachIteration</a>, <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a>);</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>        }</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span> </div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>        <span class="comment">// We compute the transposed matrix of the global relation matrix</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a> T_transpose_matrix(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>, <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>);</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>        SparseMatrixMultiplicationUtility::TransposeMatrix&lt;TSystemMatrixType, TSystemMatrixType&gt;(T_transpose_matrix, rTMatrix, 1.0);</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span> </div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>        <span class="comment">// The proper way to include the constants is in the RHS as T^t(f - A * g)</span></div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a> rb_copy = rb;</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a>) {</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>            <span class="comment">// We get the g constant vector</span></div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rDeltaConstantVector = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a89ef3f2d3ae4a2d0e5d65ce96c5810ae">mpDeltaConstantVector</a>;</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a> aux_constant_vector(rDeltaConstantVector);</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>            TSparseSpace::Mult(<a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rDeltaConstantVector, aux_constant_vector);</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>            TSparseSpace::UnaliasedAdd(rb_copy, -1.0, aux_constant_vector);</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>        }</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span> </div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>        <span class="comment">// The auxiliar matrix to store the intermediate matrix multiplication</span></div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a> auxiliar_A_matrix(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>, <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>);</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>        <a class="code hl_function" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ad20f647f5fd3142300bcc1145c25fb01">SparseMatrixMultiplicationUtility::MatrixMultiplication</a>(T_transpose_matrix, <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, auxiliar_A_matrix);</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span> </div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>        <span class="comment">// We do a backup of the matrix before apply the constraints</span></div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a699f63c2cd6ad28f85d4d7887960abfd">mpOldAMatrix</a> == NULL) { <span class="comment">// If the pointer is not initialized initialize it to an empty matrix</span></div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a27d137182d319891edae86abe9091ee5">TSystemMatrixPointerType</a> pNewOldAMatrix = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a27d137182d319891edae86abe9091ee5">TSystemMatrixPointerType</a>(<span class="keyword">new</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>(0, 0));</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>            <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a699f63c2cd6ad28f85d4d7887960abfd">mpOldAMatrix</a>.swap(pNewOldAMatrix);</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>        }</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>        (*mpOldAMatrix).swap(<a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>);</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>        <span class="comment">// We resize of system of equations</span></div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>        <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>.resize(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>, <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>        rb.resize(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span> </div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>        <span class="comment">// Final multiplication</span></div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>        <a class="code hl_function" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ad20f647f5fd3142300bcc1145c25fb01">SparseMatrixMultiplicationUtility::MatrixMultiplication</a>(auxiliar_A_matrix, rTMatrix, <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>);</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>        TSparseSpace::Mult(T_transpose_matrix, rb_copy, rb);</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span> </div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>        <span class="comment">// Cleaning up memory</span></div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>        auxiliar_A_matrix.resize(0, 0, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>        T_transpose_matrix.resize(0, 0, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span> </div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt;= 1) &lt;&lt; <span class="stringliteral">&quot;Constraint relation build time and multiplication: &quot;</span> &lt;&lt; <a class="code hl_namespace" href="../../d5/d83/namespacetimer.html">timer</a>.ElapsedSeconds() &lt;&lt; std::endl;</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span> </div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 2) &lt;&lt; <span class="stringliteral">&quot;Finished parallel building with constraints&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span> </div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>    }</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span> </div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2d1139b0c2844483362d84110491c7e8"> 1159</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2d1139b0c2844483362d84110491c7e8">BuildRHSNoDirichlet</a>(</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>        )</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>    {</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span> </div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>        <span class="comment">// Assemble the constraints</span></div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_namespace" href="../../d5/d83/namespacetimer.html">timer</a> = <a class="code hl_class" href="../../d3/d5a/class_kratos_1_1_builtin_timer.html">BuiltinTimer</a>();</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span> </div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>        <span class="comment">// We get the global T matrix</span></div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; rTMatrix = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">mpTMatrix</a>;</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span> </div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>        <span class="comment">// We compute only once (or if cleared)</span></div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a428ff44448da78ec23c238b82977375b">mCleared</a>) {</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>            <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a428ff44448da78ec23c238b82977375b">mCleared</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>            ComputeConstraintContribution(pScheme, rModelPart, <span class="keyword">true</span>, <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a>);</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a68a996b72c2d643c49db01f8d5f8cea6">mResetRelationMatrixEachIteration</a>) {</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>            ResetConstraintSystem();</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>            ComputeConstraintContribution(pScheme, rModelPart, <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a68a996b72c2d643c49db01f8d5f8cea6">mResetRelationMatrixEachIteration</a>, <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a>);</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>        }</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span> </div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>        <span class="comment">// We compute the transposed matrix of the global relation matrix</span></div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a> T_transpose_matrix(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>, <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>);</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>        SparseMatrixMultiplicationUtility::TransposeMatrix&lt;TSystemMatrixType, TSystemMatrixType&gt;(T_transpose_matrix, rTMatrix, 1.0);</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span> </div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>        <span class="comment">// We build the original system</span></div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a> A; <span class="comment">// Dummy auxiliar matrix we ned to build anyway because are needed to impose the rigid displacements</span></div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a>) {</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>            A.resize(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>            <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a236305006a4abafe3176624f9c74d1c3">ConstructMatrixStructure</a>(pScheme, A, rModelPart);</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>            BuildWithoutConstraints(pScheme, rModelPart, A, rb);</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>            BuildRHSNoDirichletWithoutConstraints(pScheme, rModelPart, rb);</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>        }</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span> </div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>        <span class="comment">// The proper way to include the constants is in the RHS as T^t(f - A * g)</span></div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a> rb_copy = rb;</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a>) {</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>            <span class="comment">// We get the g constant vector</span></div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rDeltaConstantVector = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a89ef3f2d3ae4a2d0e5d65ce96c5810ae">mpDeltaConstantVector</a>;</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a> aux_constant_vector(rDeltaConstantVector);</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>            TSparseSpace::Mult(A, rDeltaConstantVector, aux_constant_vector);</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>            TSparseSpace::UnaliasedAdd(rb_copy, -1.0, aux_constant_vector);</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>        }</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span> </div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>        rb.resize(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span> </div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>        <span class="comment">// Final multiplication</span></div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>        TSparseSpace::Mult(T_transpose_matrix, rb_copy, rb);</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span> </div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt;= 1) &lt;&lt; <span class="stringliteral">&quot;Constraint relation build time and multiplication: &quot;</span> &lt;&lt; timer.ElapsedSeconds() &lt;&lt; std::endl;</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span> </div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 2) &lt;&lt; <span class="stringliteral">&quot;Finished parallel building with constraints&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span> </div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>    }</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span> </div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6aa73dd0b771e56c1071631b86eb1f6e"> 1226</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6aa73dd0b771e56c1071631b86eb1f6e">ResizeAndInitializeVectors</a>(</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a27d137182d319891edae86abe9091ee5">TSystemMatrixPointerType</a>&amp; pA,</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abbf8fabbf7de8150e696b3fb7804759c">TSystemVectorPointerType</a>&amp; pDx,</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abbf8fabbf7de8150e696b3fb7804759c">TSystemVectorPointerType</a>&amp; pb,</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>        )<span class="keyword"> override</span></div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>        <span class="comment">// We resize the basic system</span></div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>        <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a723a76a8797ffc71e7518f5a2008f54a">BaseType::ResizeAndInitializeVectors</a>(pScheme, pA, pDx, pb, rModelPart);</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span> </div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>        <span class="comment">// If needed resize the vector for the calculation of reactions</span></div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#adf722c4e501d8e245fc554bd97beab1d">BaseType::mCalculateReactionsFlag</a>) {</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad57451ea05aecad680fa5936b2cce345">SizeType</a> reactions_vector_size = <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.size() - <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a> + <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.size();</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rReactionsVector = *(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a77fcbfce08aab91bcb13400df7b1d401">BaseType::mpReactionsVector</a>);</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>            <span class="keywordflow">if</span> (rReactionsVector.size() != reactions_vector_size)</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>                rReactionsVector.resize(reactions_vector_size, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>        }</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span> </div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>        <span class="comment">// Now we resize the relation matrix used on the MPC solution</span></div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>        <span class="keywordflow">if</span>(rModelPart.MasterSlaveConstraints().size() &gt; 0) {</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">mpTMatrix</a> == NULL) { <span class="comment">// If the pointer is not initialized initialize it to an empty matrix</span></div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>                <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a27d137182d319891edae86abe9091ee5">TSystemMatrixPointerType</a> pNewT = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a27d137182d319891edae86abe9091ee5">TSystemMatrixPointerType</a>(<span class="keyword">new</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>(0, 0));</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>                <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">mpTMatrix</a>.swap(pNewT);</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>            }</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span> </div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>            <span class="comment">// The rigid movement</span></div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aaad19ea5b5d84c24e3b2b6bb22bb7346">mpConstantVector</a> == NULL) { <span class="comment">// If the pointer is not initialized initialize it to an empty vector</span></div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>                <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abbf8fabbf7de8150e696b3fb7804759c">TSystemVectorPointerType</a> pNewConstantVector = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abbf8fabbf7de8150e696b3fb7804759c">TSystemVectorPointerType</a>(<span class="keyword">new</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>(0));</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>                <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aaad19ea5b5d84c24e3b2b6bb22bb7346">mpConstantVector</a>.swap(pNewConstantVector);</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>            }</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span> </div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>            <span class="comment">// The effective rigid movement</span></div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a89ef3f2d3ae4a2d0e5d65ce96c5810ae">mpDeltaConstantVector</a> == NULL) { <span class="comment">// If the pointer is not initialized initialize it to an empty vector</span></div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>                <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abbf8fabbf7de8150e696b3fb7804759c">TSystemVectorPointerType</a> pNewConstantVector = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abbf8fabbf7de8150e696b3fb7804759c">TSystemVectorPointerType</a>(<span class="keyword">new</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>(0));</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>                <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a89ef3f2d3ae4a2d0e5d65ce96c5810ae">mpDeltaConstantVector</a>.swap(pNewConstantVector);</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>            }</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span> </div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>            <span class="comment">// System matrices/vectors</span></div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; rTMatrix = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">mpTMatrix</a>;</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rConstantVector = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aaad19ea5b5d84c24e3b2b6bb22bb7346">mpConstantVector</a>;</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rDeltaConstantVector = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a89ef3f2d3ae4a2d0e5d65ce96c5810ae">mpDeltaConstantVector</a>;</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span> </div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>            <span class="comment">// Resizing the system matrix</span></div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>            <span class="keywordflow">if</span> (rTMatrix.size1() == 0 || <a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#aa4cf0a493c34278ce36248b94ffc7247">BaseType::GetReshapeMatrixFlag</a>() || <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a428ff44448da78ec23c238b82977375b">mCleared</a>) { <span class="comment">// If the matrix is not initialized</span></div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>                rTMatrix.resize(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>                <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab96c33010353414ca9fe9938d3705e64">ConstructRelationMatrixStructure</a>(pScheme, rTMatrix, rModelPart);</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>                <span class="keywordflow">if</span> (rTMatrix.size1() != <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a> || rTMatrix.size2() != <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>) {</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>                    <a class="code hl_define" href="../../d5/d4d/group___kratos_core.html#ga376e02451bc7cc3a5fd77b57f0549e6b">KRATOS_ERROR</a> &lt;&lt;<span class="stringliteral">&quot;The equation system size has changed during the simulation. This is not permitted.&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>                    rTMatrix.resize(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>                    <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab96c33010353414ca9fe9938d3705e64">ConstructRelationMatrixStructure</a>(pScheme, rTMatrix, rModelPart);</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>                }</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>            }</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span> </div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>            <span class="comment">// Resizing the system vector</span></div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>            <span class="comment">// The rigid movement</span></div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>            <span class="keywordflow">if</span> (rConstantVector.size() != <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a> || <a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#aa4cf0a493c34278ce36248b94ffc7247">BaseType::GetReshapeMatrixFlag</a>() || <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a428ff44448da78ec23c238b82977375b">mCleared</a>) {</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>                rConstantVector.resize(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>                <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a> = ComputeConstraintContribution(pScheme, rModelPart);</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>                <span class="keywordflow">if</span> (rConstantVector.size() != <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>                    <a class="code hl_define" href="../../d5/d4d/group___kratos_core.html#ga376e02451bc7cc3a5fd77b57f0549e6b">KRATOS_ERROR</a> &lt;&lt;<span class="stringliteral">&quot;The equation system size has changed during the simulation. This is not permitted.&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>                    rConstantVector.resize(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>                    <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a> = ComputeConstraintContribution(pScheme, rModelPart);</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>                }</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>            }</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>            <span class="comment">// The effective rigid movement</span></div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a>) {</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>                <span class="keywordflow">if</span> (rDeltaConstantVector.size() != <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a> || <a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#aa4cf0a493c34278ce36248b94ffc7247">BaseType::GetReshapeMatrixFlag</a>() || <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a428ff44448da78ec23c238b82977375b">mCleared</a>) {</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>                    rDeltaConstantVector.resize(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>                    <span class="keywordflow">if</span> (rDeltaConstantVector.size() != <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>                        <a class="code hl_define" href="../../d5/d4d/group___kratos_core.html#ga376e02451bc7cc3a5fd77b57f0549e6b">KRATOS_ERROR</a> &lt;&lt;<span class="stringliteral">&quot;The equation system size has changed during the simulation. This is not permitted.&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>                        rDeltaConstantVector.resize(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>                    }</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>                }</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>            }</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>        }</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>    }</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span> </div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6e174804285252cb759c0bbd47a857ea"> 1315</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6e174804285252cb759c0bbd47a857ea">CalculateReactions</a>(</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>,</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rDx,</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>        )<span class="keyword"> override</span></div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span> </div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>        <span class="comment">// Refresh RHS to have the correct reactions</span></div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>        <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a02834840a6ce4afcbeeb37ab16b34f17">BuildRHS</a>(pScheme, rModelPart, rb);</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span> </div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>        <span class="comment">// Adding contribution to reactions</span></div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; r_reactions_vector = *<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a77fcbfce08aab91bcb13400df7b1d401">BaseType::mpReactionsVector</a>;</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span> </div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>        <span class="comment">// Updating variables</span></div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; r_dof : <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>) {</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>            <span class="keywordflow">if</span> ((r_dof.IsFixed()) || <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.find(r_dof) != <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.end()) {</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>                r_dof.GetSolutionStepReactionValue() = -r_reactions_vector[<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab67cb7c7d40bea63853df126c770541d">mReactionEquationIdMap</a>[r_dof.EquationId()]];</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>            }</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>        }</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span> </div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints::CalculateReactions failed ..&quot;</span>);</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>    }</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span> </div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a3ef8d55c96702d9cb9d13724070c3b97"> 1350</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a3ef8d55c96702d9cb9d13724070c3b97">ApplyDirichletConditions</a>(</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>,</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rDx,</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>        )<span class="keyword"> override</span></div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a>;</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span> </div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.size() &gt; 0) {</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>            <span class="comment">// We apply the same method as in the block builder and solver but instead of fixing the fixed Dofs, we just fix the master fixed Dofs</span></div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>            std::vector&lt;double&gt; scaling_factors (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>, 0.0);</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span> </div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>            <span class="comment">// NOTE: Dofs are assumed to be numbered consecutively</span></div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>            <span class="keyword">const</span> <span class="keyword">auto</span> it_dof_begin = <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.begin();</div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> counter = 0;</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i = 0; i &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.size(); ++i) {</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>                <span class="keyword">auto</span> it_dof = it_dof_begin + i;</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> equation_id = it_dof-&gt;EquationId();</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>                <span class="keywordflow">if</span> (equation_id &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a> ) {</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>                    <span class="keyword">auto</span> it_first_check = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.find(*it_dof);</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>                    <span class="keywordflow">if</span> (it_first_check == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.end()) {</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>                        <span class="keyword">auto</span> it_second_check = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.find(*it_dof);</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>                        <span class="keywordflow">if</span> (it_second_check == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.end()) {</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>                            <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.find(*it_dof) == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.end()) {</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>                                scaling_factors[counter] = 1.0;</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>                            }</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>                        }</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>                        counter += 1;</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>                    }</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>                }</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>            }</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span> </div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>            <span class="keywordtype">double</span>* Avalues = <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>.value_data().begin();</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a>* Arow_indices = <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>.index1_data().begin();</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a>* Acol_indices = <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>.index2_data().begin();</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span> </div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>            <span class="comment">// Define  zero value tolerance</span></div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> zero_tolerance = std::numeric_limits&lt;double&gt;::epsilon();</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span> </div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>            <span class="comment">// Detect if there is a line of all zeros and set the diagonal to a 1 if this happens</span></div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span><span class="preprocessor">            #pragma omp parallel for</span></div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; static_cast&lt;int&gt;(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>); ++k) {</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> col_begin = Arow_indices[k];</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> col_end = Arow_indices[k+1];</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>                <span class="keywordtype">bool</span> empty = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> j = col_begin; j &lt; col_end; ++j) {</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>                    <span class="keywordflow">if</span>(std::abs(Avalues[j]) &gt; zero_tolerance) {</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>                        empty = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>                    }</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>                }</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span> </div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>                <span class="keywordflow">if</span>(empty) {</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>                    <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>(k,k) = 1.0;</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>                    rb[k] = 0.0;</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>                }</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>            }</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span> </div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>            <a class="code hl_class" href="../../d9/d9b/class_kratos_1_1_index_partition.html">IndexPartition&lt;std::size_t&gt;</a>(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>).<a class="code hl_function" href="../../d9/d9b/class_kratos_1_1_index_partition.html#af1ce67064923939c2a8a0172cdb5e344">for_each</a>([&amp;](std::size_t Index){</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> col_begin = Arow_indices[Index];</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> col_end = Arow_indices[Index+1];</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> k_factor = scaling_factors[Index];</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>                <span class="keywordflow">if</span> (k_factor == 0) {</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>                    <span class="comment">// Zero out the whole row, except the diagonal</span></div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>                    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> j = col_begin; j &lt; col_end; ++j)</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>                        <span class="keywordflow">if</span> (Acol_indices[j] != Index )</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>                            Avalues[j] = 0.0;</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span> </div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>                    <span class="comment">// Zero out the RHS</span></div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>                    rb[Index] = 0.0;</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>                    <span class="comment">// Zero out the column which is associated with the zero&#39;ed row</span></div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>                    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> j = col_begin; j &lt; col_end; ++j) {</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>                        <span class="keywordflow">if</span>(scaling_factors[ Acol_indices[j] ] == 0 ) {</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>                            Avalues[j] = 0.0;</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>                        }</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>                    }</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>                }</div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>            });</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>        }</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span> </div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>    }</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span> </div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a4619d0acc5fb54213ce59009ea868868"> 1439</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a4619d0acc5fb54213ce59009ea868868">Clear</a>()<span class="keyword"> override</span></div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>        <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#abe16593f21409370809c981420bd56fc">BaseType::Clear</a>();</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span> </div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>        <span class="comment">// Resetting auxiliar set of dofs</span></div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>        <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a> = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad2ed4c63bee6cb6824710e29e367f145">DofsArrayType</a>();</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>        <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a> = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad2ed4c63bee6cb6824710e29e367f145">DofsArrayType</a>();</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span> </div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>        <span class="comment">// Clearing the relation map</span></div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>        <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab67cb7c7d40bea63853df126c770541d">mReactionEquationIdMap</a>.clear();</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span> </div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>        <span class="comment">// Clear constraint system</span></div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">mpTMatrix</a> != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>            TSparseSpace::Clear(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">mpTMatrix</a>);</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aaad19ea5b5d84c24e3b2b6bb22bb7346">mpConstantVector</a> != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>            TSparseSpace::Clear(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aaad19ea5b5d84c24e3b2b6bb22bb7346">mpConstantVector</a>);</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a89ef3f2d3ae4a2d0e5d65ce96c5810ae">mpDeltaConstantVector</a> != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>            TSparseSpace::Clear(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a89ef3f2d3ae4a2d0e5d65ce96c5810ae">mpDeltaConstantVector</a>);</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span> </div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span>        <span class="comment">// Set the flag</span></div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>        <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a428ff44448da78ec23c238b82977375b">mCleared</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span> </div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>        <a class="code hl_define" href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints&quot;</span>, this-&gt;<a class="code hl_function" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 1) &lt;&lt; <span class="stringliteral">&quot;Clear Function called&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>    }</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span> </div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"><a class="line" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab9c1fb8f6d6ae982b4386bb2e625bd23"> 1468</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab9c1fb8f6d6ae982b4386bb2e625bd23">AssignSettings</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../da/d39/class_parameters.html">Parameters</a> ThisParameters)<span class="keyword"> override</span></div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>        <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#ae09b93cc9b819ea302667f8e0e54aa9a">BaseType::AssignSettings</a>(ThisParameters);</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>        <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2cb4b9f2b5a37e05e21648ae80a65f52">mCheckConstraintRelation</a> = ThisParameters[<span class="stringliteral">&quot;check_constraint_relation&quot;</span>].GetBool();</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>        <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a68a996b72c2d643c49db01f8d5f8cea6">mResetRelationMatrixEachIteration</a> = ThisParameters[<span class="stringliteral">&quot;reset_relation_matrix_each_iteration&quot;</span>].GetBool();</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>    }</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span> </div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span> </div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span> </div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span> </div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span> </div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span> </div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span> </div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span> </div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span> </div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span>    <span class="keywordtype">void</span> SetUpSystemWithConstraints(<a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart)</div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>    {</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span> </div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>        <span class="comment">// First we set up the system of equations without constraints</span></div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>        <span class="comment">// Set equation id for degrees of freedom the free degrees of freedom are positioned at the beginning of the system, while the fixed one are at the end (in opposite order).</span></div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>        <span class="comment">//</span></div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>        <span class="comment">// That means that if the EquationId is greater than &quot;mEquationSystemSize&quot; the pointed degree of freedom is restrained</span></div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>        <span class="comment">// This is almost the same SetUpSystem from ResidualBasedEliminationBuilderAndSolver, but we don&#39;t discard from the system the fixed dofs that are part of a constraint at the same time</span></div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span> </div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span> </div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>        <span class="comment">// The current process info</span></div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>        <span class="keyword">const</span> <a class="code hl_enumvalue" href="../../db/d66/namespace_kratos.html#a1514eea722d243fa5561f7050c071b9fa72b048930550a0e11889dd0ac17b0439">ProcessInfo</a>&amp; r_current_process_info = rModelPart.GetProcessInfo();</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span> </div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>        <span class="comment">// Vector containing the localization in the system of the different terms</span></div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a5bc211023f9e20b6862f19175dfac73d">DofsVectorType</a> slave_dof_list, master_dof_list;</div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span> </div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>        <span class="comment">// Declaring temporal variables</span></div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad2ed4c63bee6cb6824710e29e367f145">DofsArrayType</a> dof_temp_fixed_master;</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span> </div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>        <span class="keyword">typedef</span> std::unordered_set &lt; DofPointerType, DofPointerHasher&gt; set_type;</div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>        set_type dof_global_fixed_master_set;</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span> </div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>        <span class="comment">// Iterate over constraints</span></div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> number_of_constraints = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(rModelPart.MasterSlaveConstraints().size());</div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>        <span class="keyword">const</span> <span class="keyword">auto</span> it_const_begin = rModelPart.MasterSlaveConstraints().begin();</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span><span class="preprocessor">        #pragma omp parallel firstprivate(slave_dof_list, master_dof_list)</span></div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>        {</div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>            <span class="comment">// We cleate the temporal set and we reserve some space on them</span></div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>            set_type dof_temp_fixed_master_set;</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>            dof_temp_fixed_master_set.reserve(2000);</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span> </div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span><span class="preprocessor">            #pragma omp for schedule(guided, 512) nowait</span></div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_const = 0; i_const &lt; number_of_constraints; ++i_const) {</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>                <span class="keyword">auto</span> it_const = it_const_begin + i_const;</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span> </div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>                <span class="comment">// Detect if the constraint is active or not. If the user did not make any choice the constraint</span></div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>                <span class="comment">// It is active by default</span></div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>                <span class="keywordtype">bool</span> constraint_is_active = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>                <span class="keywordflow">if</span> (it_const-&gt;IsDefined(ACTIVE))</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>                    constraint_is_active = it_const-&gt;Is(ACTIVE);</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span> </div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>                <span class="keywordflow">if</span> (constraint_is_active) {</div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>                    it_const-&gt;GetDofList(slave_dof_list, master_dof_list, r_current_process_info);</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span> </div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>                    <span class="comment">// Filling the set of dofs master and fixed at the same time</span></div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; master_dof : master_dof_list) {</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>                        <span class="keywordflow">if</span> (master_dof-&gt;IsFixed()) {</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>                            dof_temp_fixed_master_set.insert(master_dof);</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>                        }</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>                    }</div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>                }</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>            }</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span> </div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>            <span class="comment">// We merge all the sets in one thread</span></div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span><span class="preprocessor">            #pragma omp critical</span></div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>            {</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>                dof_global_fixed_master_set.insert(dof_temp_fixed_master_set.begin(), dof_temp_fixed_master_set.end());</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>            }</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>        }</div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span> </div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>        dof_temp_fixed_master.reserve(dof_global_fixed_master_set.size());</div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> p_dof : dof_global_fixed_master_set) {</div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>            dof_temp_fixed_master.push_back( p_dof );</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>        }</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>        dof_temp_fixed_master.Sort();</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>        <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a> = dof_temp_fixed_master;</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span> </div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>        <span class="keywordtype">int</span> free_id = 0;</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>        <span class="keywordtype">int</span> fix_id = <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.size();</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span> </div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; dof : <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>) {</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/df2/namespaceode__solve.html#a3c949810f9da8ea09afa47003dedc1e3">dof</a>.IsFixed()) {</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>                <span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.find(dof);</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>                <span class="keywordflow">if</span> (it == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.end()) {</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>                    <a class="code hl_variable" href="../../d2/df2/namespaceode__solve.html#a3c949810f9da8ea09afa47003dedc1e3">dof</a>.SetEquationId(--fix_id);</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>                    <a class="code hl_variable" href="../../d2/df2/namespaceode__solve.html#a3c949810f9da8ea09afa47003dedc1e3">dof</a>.SetEquationId(free_id++);</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>                }</div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span>                <a class="code hl_variable" href="../../d2/df2/namespaceode__solve.html#a3c949810f9da8ea09afa47003dedc1e3">dof</a>.SetEquationId(free_id++);</div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span>            }</div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>        }</div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span> </div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>        <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a> = fix_id;</div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span> </div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>        <span class="comment">// Add the computation of the global ids of the solvable dofs</span></div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> <a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> = 0;</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; dof : <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>) {</div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/df2/namespaceode__solve.html#a3c949810f9da8ea09afa47003dedc1e3">dof</a>.EquationId() &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>                <span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.find(dof);</div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span>                <span class="keywordflow">if</span> (it == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.end()) {</div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>                    ++<a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>;</div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>                }</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>            }</div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>        }</div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span> </div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>        <span class="comment">// The total system of equations to be solved</span></div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>        <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a> = <a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>;</div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span> </div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>        <span class="comment">// Finally we build the relation between the EquationID and the component of the reaction</span></div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>        <a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> = 0;</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; r_dof : <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>) {</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>            <span class="keyword">const</span> <span class="keywordtype">bool</span> is_master_fixed = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.find(r_dof) == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.end() ? false : <span class="keyword">true</span>;</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>            <span class="keyword">const</span> <span class="keywordtype">bool</span> is_slave = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.find(r_dof) == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.end() ? false : <span class="keyword">true</span>;</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>            <span class="keywordflow">if</span> (is_master_fixed || is_slave) { <span class="comment">// Fixed or MPC dof</span></div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>                <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab67cb7c7d40bea63853df126c770541d">mReactionEquationIdMap</a>.insert({r_dof.EquationId(), <a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>});</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>                ++<a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>;</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>            }</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>        }</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span> </div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints::SetUpSystemWithConstraints failed ..&quot;</span>);</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>    }</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span> </div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>    <span class="keywordtype">void</span> ApplyMasterSlaveRelation(</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>,</div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rDx,</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>        )</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>    {</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span> </div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>        <span class="comment">// First we reset the slave dofs</span></div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>        <a class="code hl_function" href="../../d3/da5/namespace_kratos_1_1_constraint_utilities.html#ad37af926e550038d34dedb258fa4daad">ConstraintUtilities::ResetSlaveDofs</a>(rModelPart);</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span> </div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>        <span class="comment">// Now we apply the constraints</span></div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>        <a class="code hl_function" href="../../d3/da5/namespace_kratos_1_1_constraint_utilities.html#a9322ce7618f2779ee5c6171d0d9d3303">ConstraintUtilities::ApplyConstraints</a>(rModelPart);</div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span> </div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>    }</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span> </div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>    <span class="keywordtype">bool</span> CheckMasterSlaveRelation(</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rDx,</div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rDxSolved</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>        )</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span>    {</div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span> </div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>        <span class="comment">// Auxiliar values</span></div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>        <span class="keyword">const</span> <span class="keyword">auto</span> it_dof_begin = <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.begin();</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a> current_solution(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>);</div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a> updated_solution(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>);</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a> residual_solution(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>);</div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span> </div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>        <span class="comment">// Get current values</span></div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> <a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> = 0;</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i = 0; <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.size(); ++<a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>) {</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>            <span class="keyword">auto</span> it_dof = it_dof_begin + <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>;</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> equation_id = it_dof-&gt;EquationId();</div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>            <span class="keywordflow">if</span> (equation_id &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a> ) {</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>                <span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.find(*it_dof);</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>                <span class="keywordflow">if</span> (it == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.end()) {</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span>                    current_solution[<a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>] = it_dof-&gt;GetSolutionStepValue() + rDxSolved[<a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>];</div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span>                    <a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> += 1;</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>                }</div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>            }</div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>        }</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span> </div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>        <a class="code hl_function" href="../../db/d66/namespace_kratos.html#a07ef8a5b8886ded903a1e7ad4c0df960">block_for_each</a>(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>, [&amp;, <span class="keyword">this</span>](Dof&lt;double&gt;&amp; rDof){</div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> equation_id = rDof.EquationId();</div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>            <span class="keywordflow">if</span> (equation_id &lt; this-&gt;<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">mEquationSystemSize</a> ) {</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>                residual_solution[equation_id] = rDof.GetSolutionStepValue() + rDx[equation_id];</div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>            }</div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>        });</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span> </div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>        <span class="comment">// Apply master slave constraints</span></div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; rTMatrix = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">mpTMatrix</a>;</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>        TSparseSpace::Mult(rTMatrix, current_solution, updated_solution);</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span> </div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a>) {</div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>            ComputeConstraintContribution(pScheme, rModelPart, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rConstantVector = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aaad19ea5b5d84c24e3b2b6bb22bb7346">mpConstantVector</a>;</div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span>            TSparseSpace::UnaliasedAdd(updated_solution, 1.0, rConstantVector);</div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>        }</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span> </div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>        TSparseSpace::UnaliasedAdd(residual_solution, -1.0, updated_solution);</div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span> </div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>        <span class="comment">// Check database</span></div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; static_cast&lt;int&gt;(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>); ++<a class="code hl_variable" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>) {</div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>            <span class="keywordflow">if</span> (std::abs(residual_solution[k]) &gt; std::numeric_limits&lt;double&gt;::epsilon()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>        }</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span> </div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span> </div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>    }</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span> </div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>    <span class="keywordtype">void</span> ReconstructSlaveSolutionAfterSolve(</div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>,</div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rDx,</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>        )</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>    {</div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span> </div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>        <span class="comment">// We get the global T matrix and the constant vector</span></div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; rTMatrix = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">mpTMatrix</a>;</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span> </div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>        <span class="comment">// We reconstruct the complete vector of Unknowns</span></div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a> Dx_copy = <a class="code hl_variable" href="../../da/dec/namespace_kratos_1_1_mortar_utilities.html#a945773babf1a22ee5a6abec98284a460">rDx</a>;</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>        <a class="code hl_variable" href="../../da/dec/namespace_kratos_1_1_mortar_utilities.html#a945773babf1a22ee5a6abec98284a460">rDx</a>.<a class="code hl_function" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html#a3d36c583d63e7eeda493a7abdc97d874">resize</a>(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>);</div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>        TSparseSpace::Mult(rTMatrix, Dx_copy, rDx);</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span> </div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>        <span class="comment">// Add the constant vector</span></div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a>) {</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rDeltaConstantVector = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a89ef3f2d3ae4a2d0e5d65ce96c5810ae">mpDeltaConstantVector</a>;</div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>            TSparseSpace::UnaliasedAdd(rDx, 1.0, rDeltaConstantVector);</div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>        }</div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span> </div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>        <span class="comment">// We check the solution</span></div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2cb4b9f2b5a37e05e21648ae80a65f52">mCheckConstraintRelation</a>) {</div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>            <a class="code hl_define" href="../../d5/d4d/group___kratos_core.html#ga421c079910a05f8a88688b045190ac9b">KRATOS_ERROR_IF_NOT</a>(CheckMasterSlaveRelation(pScheme, rModelPart, rDx, Dx_copy)) &lt;&lt; <span class="stringliteral">&quot;The relation between master/slave dofs is not respected&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>        }</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span> </div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span>        <span class="comment">// Simply restore old LHS</span></div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>        (<a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>).swap(*<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a699f63c2cd6ad28f85d4d7887960abfd">mpOldAMatrix</a>);</div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>        <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a699f63c2cd6ad28f85d4d7887960abfd">mpOldAMatrix</a> = NULL;</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span> </div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>        <span class="comment">// Reconstruct the RHS</span></div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a> rb_copy = rb;</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>        rb.resize(<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>        TSparseSpace::Mult(rTMatrix, rb_copy, rb);</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span> </div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolverWithConstraints::ReconstructSlaveSolutionAfterSolve failed ..&quot;</span>);</div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>    }</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span> </div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>    <span class="keywordtype">void</span> BuildWithoutConstraints(</div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>,</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span>        )</div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>    {</div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>        <span class="comment">// The current process info</span></div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>        <span class="keyword">const</span> <a class="code hl_enumvalue" href="../../db/d66/namespace_kratos.html#a1514eea722d243fa5561f7050c071b9fa72b048930550a0e11889dd0ac17b0439">ProcessInfo</a>&amp; r_current_process_info = <a class="code hl_variable" href="../../db/d91/namespace_kratos_1_1_rans_variable_utilities.html#a59c7e204dd415b212e4726b5e2bcbc82">rModelPart</a>.GetProcessInfo();</div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span> </div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>        <span class="comment">// Getting the array of elements</span></div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a4757f6a4bfb8f4a10b2c6d5a8c55d907">ElementsArrayType</a>&amp; r_elements_array = <a class="code hl_variable" href="../../db/d91/namespace_kratos_1_1_rans_variable_utilities.html#a59c7e204dd415b212e4726b5e2bcbc82">rModelPart</a>.Elements();</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span> </div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span>        <span class="comment">// Getting the array of the conditions</span></div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a45cc985b9e9eb40ed8337f0c70f29cbe">ConditionsArrayType</a>&amp; r_conditons_array = <a class="code hl_variable" href="../../db/d91/namespace_kratos_1_1_rans_variable_utilities.html#a59c7e204dd415b212e4726b5e2bcbc82">rModelPart</a>.Conditions();</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span> </div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>        <span class="comment">// Contributions to the system</span></div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6aed94fbf245f3cf68d79c5171a68f94">LocalSystemMatrixType</a> lhs_contribution = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6aed94fbf245f3cf68d79c5171a68f94">LocalSystemMatrixType</a>(0, 0);</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae469a111c2b8079ba9f70e7785406d36">LocalSystemVectorType</a> rhs_contribution = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae469a111c2b8079ba9f70e7785406d36">LocalSystemVectorType</a>(0);</div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span> </div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>        <span class="comment">// Vector containing the localization in the system of the different terms</span></div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>        <a class="code hl_typedef" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> equation_id;</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span> </div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>        <span class="comment">// Assemble all elements and conditions</span></div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span><span class="preprocessor">        #pragma omp parallel firstprivate( lhs_contribution, rhs_contribution, equation_id)</span></div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span>        {</div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>            <span class="comment">// Elements</span></div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>            <span class="keyword">const</span> <span class="keyword">auto</span> it_elem_begin = r_elements_array.begin();</div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> nelements = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(r_elements_array.size());</div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span><span class="preprocessor">            #pragma omp for schedule(guided, 512) nowait</span></div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>&lt;nelements; ++<a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>) {</div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>                <span class="keyword">auto</span> it_elem = it_elem_begin + <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>;</div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span>                <span class="comment">// Detect if the element is active or not. If the user did not make any choice the element is active by default</span></div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span>                <span class="keywordtype">bool</span> element_is_active = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span>                <span class="keywordflow">if</span> (it_elem-&gt;IsDefined(ACTIVE))</div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>                    element_is_active = it_elem-&gt;Is(ACTIVE);</div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span> </div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>                <span class="keywordflow">if</span> (element_is_active) {</div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>                    <span class="comment">// Calculate elemental contribution</span></div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>                    pScheme-&gt;CalculateSystemContributions(*it_elem, lhs_contribution, rhs_contribution, equation_id, r_current_process_info);</div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span> </div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>                    <span class="comment">// Assemble the elemental contribution</span></div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span>                    AssembleWithoutConstraints(<a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rb, lhs_contribution, rhs_contribution, equation_id);</div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>                }</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>            }</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span> </div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>            <span class="comment">// Conditions</span></div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span>            <span class="keyword">const</span> <span class="keyword">auto</span> it_cond_begin = r_conditons_array.begin();</div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> nconditions = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(r_conditons_array.size());</div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span><span class="preprocessor">            #pragma omp  for schedule(guided, 512)</span></div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>&lt;nconditions; ++<a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>) {</div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span>                <span class="keyword">auto</span> it_cond = it_cond_begin + <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>;</div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span>                <span class="comment">// Detect if the element is active or not. If the user did not make any choice the element is active by default</span></div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span>                <span class="keywordtype">bool</span> condition_is_active = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span>                <span class="keywordflow">if</span> (it_cond-&gt;IsDefined(ACTIVE))</div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>                    condition_is_active = it_cond-&gt;Is(ACTIVE);</div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span> </div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>                <span class="keywordflow">if</span> (condition_is_active) {</div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>                    <span class="comment">// Calculate elemental contribution</span></div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>                    pScheme-&gt;CalculateSystemContributions(*it_cond, lhs_contribution, rhs_contribution, equation_id, r_current_process_info);</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span> </div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span>                    <span class="comment">// Assemble the elemental contribution</span></div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span>                    AssembleWithoutConstraints(<a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rb, lhs_contribution, rhs_contribution, equation_id);</div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>                }</div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span>            }</div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span>        }</div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>    }</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span> </div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span>    <span class="keywordtype">void</span> BuildRHSNoDirichletWithoutConstraints(</div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>        )</div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>    {</div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span>        <span class="comment">// The current process info</span></div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span>        <span class="keyword">const</span> <a class="code hl_enumvalue" href="../../db/d66/namespace_kratos.html#a1514eea722d243fa5561f7050c071b9fa72b048930550a0e11889dd0ac17b0439">ProcessInfo</a>&amp; r_current_process_info = <a class="code hl_variable" href="../../db/d91/namespace_kratos_1_1_rans_variable_utilities.html#a59c7e204dd415b212e4726b5e2bcbc82">rModelPart</a>.GetProcessInfo();</div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span> </div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span>        <span class="comment">// Getting the array of elements</span></div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a4757f6a4bfb8f4a10b2c6d5a8c55d907">ElementsArrayType</a>&amp; r_elements_array = <a class="code hl_variable" href="../../db/d91/namespace_kratos_1_1_rans_variable_utilities.html#a59c7e204dd415b212e4726b5e2bcbc82">rModelPart</a>.Elements();</div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span> </div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span>        <span class="comment">// Getting the array of the conditions</span></div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a45cc985b9e9eb40ed8337f0c70f29cbe">ConditionsArrayType</a>&amp; r_conditons_array = <a class="code hl_variable" href="../../db/d91/namespace_kratos_1_1_rans_variable_utilities.html#a59c7e204dd415b212e4726b5e2bcbc82">rModelPart</a>.Conditions();</div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span> </div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span>        <span class="comment">// Contributions to the system</span></div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae469a111c2b8079ba9f70e7785406d36">LocalSystemVectorType</a> rhs_contribution = <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae469a111c2b8079ba9f70e7785406d36">LocalSystemVectorType</a>(0);</div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span> </div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span>        <span class="comment">// Vector containing the localization in the system of the different terms</span></div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span>        <a class="code hl_typedef" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> equation_id;</div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span> </div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span>        <span class="comment">// Assemble all elements and conditions</span></div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span><span class="preprocessor">        #pragma omp parallel firstprivate( rhs_contribution, equation_id)</span></div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span>        {</div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span>            <span class="comment">// Elements</span></div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span>            <span class="keyword">const</span> <span class="keyword">auto</span> it_elem_begin = r_elements_array.begin();</div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> nelements = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(r_elements_array.size());</div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span><span class="preprocessor">            #pragma omp for schedule(guided, 512) nowait</span></div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>&lt;nelements; ++<a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>) {</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>                <span class="keyword">auto</span> it_elem = it_elem_begin + <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>;</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>                <span class="comment">// Detect if the element is active or not. If the user did not make any choice the element is active by default</span></div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>                <span class="keywordtype">bool</span> element_is_active = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>                <span class="keywordflow">if</span> (it_elem-&gt;IsDefined(ACTIVE))</div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>                    element_is_active = it_elem-&gt;Is(ACTIVE);</div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span> </div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span>                <span class="keywordflow">if</span> (element_is_active) {</div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>                    <span class="comment">// Calculate elemental Right Hand Side Contribution</span></div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span>                    pScheme-&gt;CalculateRHSContribution(*it_elem, rhs_contribution, equation_id, r_current_process_info);</div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span> </div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>                    <span class="comment">// Assemble the elemental contribution</span></div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span>                    AssembleRHSWithoutConstraints(rb, rhs_contribution, equation_id);</div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span>                }</div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>            }</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span> </div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>            <span class="comment">// Conditions</span></div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span>            <span class="keyword">const</span> <span class="keyword">auto</span> it_cond_begin = r_conditons_array.begin();</div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> nconditions = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(r_conditons_array.size());</div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span><span class="preprocessor">            #pragma omp  for schedule(guided, 512)</span></div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>&lt;nconditions; ++<a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>) {</div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>                <span class="keyword">auto</span> it_cond = it_cond_begin + <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>;</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span>                <span class="comment">// Detect if the element is active or not. If the user did not make any choice the element is active by default</span></div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>                <span class="keywordtype">bool</span> condition_is_active = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span>                <span class="keywordflow">if</span> (it_cond-&gt;IsDefined(ACTIVE))</div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>                    condition_is_active = it_cond-&gt;Is(ACTIVE);</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span> </div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>                <span class="keywordflow">if</span> (condition_is_active) {</div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span>                    <span class="comment">// Calculate elemental contribution</span></div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span>                    pScheme-&gt;CalculateRHSContribution(*it_cond, rhs_contribution, equation_id, r_current_process_info);</div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span> </div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>                    <span class="comment">// Assemble the elemental contribution</span></div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>                    AssembleRHSWithoutConstraints(rb, rhs_contribution, equation_id);</div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>                }</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span>            }</div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>        }</div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>    }</div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span> </div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>    <span class="keywordtype">void</span> AssembleWithoutConstraints(</div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; <a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>,</div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb,</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6aed94fbf245f3cf68d79c5171a68f94">LocalSystemMatrixType</a>&amp; rLHSContribution,</div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae469a111c2b8079ba9f70e7785406d36">LocalSystemVectorType</a>&amp; rRHSContribution,</div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a>&amp; rEquationId</div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>        )</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span>    {</div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad57451ea05aecad680fa5936b2cce345">SizeType</a> <a class="code hl_variable" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a6ca56ca9ce0b393e572ef7e35fd945e1">local_size</a> = rLHSContribution.size1();</div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span> </div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span>        <span class="comment">// Assemble RHS</span></div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span>        AssembleRHSWithoutConstraints(rb, rRHSContribution, rEquationId);</div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span> </div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>        <span class="comment">// Assemble LHS</span></div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i_local = 0; i_local &lt; <a class="code hl_variable" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a6ca56ca9ce0b393e572ef7e35fd945e1">local_size</a>; ++i_local) {</div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i_global = rEquationId[i_local];</div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span> </div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>            <span class="keywordflow">if</span> (i_global &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>                <a class="code hl_function" href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a3f0006d49a686647dc9e7e35e5b1cf85">BaseType::AssembleRowContributionFreeDofs</a>(<a class="code hl_variable" href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">rA</a>, rLHSContribution, i_global, i_local, rEquationId);</div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span>            }</div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span>        }</div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>    }</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span> </div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span> </div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span>    <span class="keywordtype">void</span> AssembleRHSWithoutConstraints(</div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb,</div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae469a111c2b8079ba9f70e7785406d36">LocalSystemVectorType</a>&amp; rRHSContribution,</div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a>&amp; rEquationId</div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span>        )</div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span>    {</div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad57451ea05aecad680fa5936b2cce345">SizeType</a> <a class="code hl_variable" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a6ca56ca9ce0b393e572ef7e35fd945e1">local_size</a> = rRHSContribution.size();</div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span> </div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#adf722c4e501d8e245fc554bd97beab1d">BaseType::mCalculateReactionsFlag</a>) {</div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i_local = 0; i_local &lt; <a class="code hl_variable" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a6ca56ca9ce0b393e572ef7e35fd945e1">local_size</a>; ++i_local) {</div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i_global = rEquationId[i_local];</div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span> </div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>                <span class="keywordflow">if</span> (i_global &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) { <span class="comment">// free dof</span></div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>                    <span class="comment">// ASSEMBLING THE SYSTEM VECTOR</span></div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span>                    <span class="keywordtype">double</span>&amp; r_b_value = rb[i_global];</div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>                    <span class="keyword">const</span> <span class="keywordtype">double</span> rhs_value = rRHSContribution[i_local];</div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span> </div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>                    <a class="code hl_function" href="../../db/d66/namespace_kratos.html#a127b39e29fd77f2e39373d00dc48e571">AtomicAdd</a>(r_b_value, rhs_value);</div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span>                }</div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>            }</div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; r_reactions_vector = *<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a77fcbfce08aab91bcb13400df7b1d401">BaseType::mpReactionsVector</a>;</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i_local = 0; i_local &lt; <a class="code hl_variable" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a6ca56ca9ce0b393e572ef7e35fd945e1">local_size</a>; ++i_local) {</div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> i_global = rEquationId[i_local];</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>                <span class="keyword">auto</span> it_dof = <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.begin() + i_global;</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span> </div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span>                <span class="keyword">const</span> <span class="keywordtype">bool</span> is_master_fixed = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.find(*it_dof) == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.end() ? false : <span class="keyword">true</span>;</div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>                <span class="keyword">const</span> <span class="keywordtype">bool</span> is_slave = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.find(*it_dof) == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.end() ? false : <span class="keyword">true</span>;</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span>                <span class="keywordflow">if</span> (is_master_fixed || is_slave) { <span class="comment">// Fixed or MPC dof</span></div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span>                    <span class="keywordtype">double</span>&amp; r_b_value = r_reactions_vector[<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab67cb7c7d40bea63853df126c770541d">mReactionEquationIdMap</a>[i_global]];</div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>                    <span class="keyword">const</span> <span class="keywordtype">double</span> rhs_value = rRHSContribution[i_local];</div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span> </div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>                    <a class="code hl_function" href="../../db/d66/namespace_kratos.html#a127b39e29fd77f2e39373d00dc48e571">AtomicAdd</a>(r_b_value, rhs_value);</div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span>                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (it_dof-&gt;IsFree()) {  <span class="comment">// Free dof not in the MPC</span></div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span>                    <span class="comment">// ASSEMBLING THE SYSTEM VECTOR</span></div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>                    <span class="keywordtype">double</span>&amp; r_b_value = rb[i_global];</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span>                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rhs_value = rRHSContribution[i_local];</div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span> </div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span>                    <a class="code hl_function" href="../../db/d66/namespace_kratos.html#a127b39e29fd77f2e39373d00dc48e571">AtomicAdd</a>(r_b_value, rhs_value);</div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span>                }</div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>            }</div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span>        }</div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>    }</div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span> </div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span>    <span class="keywordtype">void</span> ResetConstraintSystem()</div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span>    {</div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">TSystemMatrixType</a>&amp; rTMatrix = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">mpTMatrix</a>;</div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span>        <span class="keywordtype">double</span> *Tvalues = rTMatrix.value_data().begin();</div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span> </div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span>        IndexPartition&lt;std::size_t&gt;(rTMatrix.nnz()).for_each([&amp;Tvalues](std::size_t Index){</div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span>            Tvalues[<a class="code hl_variable" href="../../da/dec/namespace_kratos_1_1_mortar_utilities.html#ab760d3f1c6c454fff50350af7ec2dc7a">Index</a>] = 0.0;</div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span>        });</div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span> </div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6c5edc52cffcb3a5c9a33fa2f1b1a7ac">IndexMapType</a> solvable_dof_reorder;</div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span> </div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>        <span class="comment">// Filling with &quot;ones&quot;</span></div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>        <span class="keyword">typedef</span> std::pair&lt;IndexType, IndexType&gt; IndexIndexPairType;</div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> <a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> = 0;</div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; dof : <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>) {</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/df2/namespaceode__solve.html#a3c949810f9da8ea09afa47003dedc1e3">dof</a>.EquationId() &lt; <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) {</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">IndexType</a> equation_id = <a class="code hl_variable" href="../../d2/df2/namespaceode__solve.html#a3c949810f9da8ea09afa47003dedc1e3">dof</a>.EquationId();</div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span>                <span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.find(dof);</div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span>                <span class="keywordflow">if</span> (it == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.end()) {</div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>                    solvable_dof_reorder.insert(IndexIndexPairType(equation_id, counter));</div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span>                    ++<a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>;</div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span>                }</div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span>            }</div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>        }</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span> </div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span>        <span class="comment">// Setting ones</span></div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; solv_dof : solvable_dof_reorder) {</div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span>            rTMatrix(solv_dof.first, solv_dof.second) = 1.0;</div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span>        }</div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span> </div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">mComputeConstantContribution</a>) {</div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span>            <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rConstantVector = *<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aaad19ea5b5d84c24e3b2b6bb22bb7346">mpConstantVector</a>;</div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span>            TSparseSpace::SetToZero(rConstantVector);</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>        }</div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>    }</div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span> </div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span>    <span class="keywordtype">void</span> ApplyDirichletConditionsRHS(</div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span>        <a class="code hl_typedef" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span>        )</div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span>    {</div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a>;</div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span> </div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">mDoFMasterFixedSet</a>.size() &gt; 0) {</div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span>            <span class="comment">// NOTE: dofs are assumed to be numbered consecutively</span></div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span>            <span class="keyword">const</span> <span class="keyword">auto</span> it_dof_begin = <a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.begin();</div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span> </div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span>            IndexPartition&lt;std::size_t&gt;(<a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">mDoFToSolveSystemSize</a>).for_each([&amp;, <span class="keyword">this</span>](std::size_t Index){</div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span>                <span class="keyword">auto</span> it_dof = it_dof_begin + <a class="code hl_variable" href="../../da/dec/namespace_kratos_1_1_mortar_utilities.html#ab760d3f1c6c454fff50350af7ec2dc7a">Index</a>;</div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span>                <span class="keywordflow">if</span> (Index &lt; this-&gt;<a class="code hl_variable" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">mEquationSystemSize</a>) {</div>
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"> 2050</span>                    <span class="keyword">auto</span> it = <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.find(*it_dof);</div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span>                    <span class="keywordflow">if</span> (it == <a class="code hl_variable" href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">mDoFSlaveSet</a>.end()) {</div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span>                        if(mDoFMasterFixedSet.find(*it_dof) != mDoFMasterFixedSet.end()) {</div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span>                            rb[Index] = 0.0;</div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span>                        }</div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span>                    }</div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span>                }</div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span>            });</div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span>        }</div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span> </div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span>    }</div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span> </div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span>    <span class="keywordtype">bool</span> ComputeConstraintContribution(</div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> ComputeTranslationMatrix = <span class="keyword">false</span>,</div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> ComputeConstantVector = <span class="keyword">false</span></div>
<div class="line"><a id="l02076" name="l02076"></a><span class="lineno"> 2076</span>        )</div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span>    {</div>
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"> 2078</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a>;</div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span> </div>
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"> 2080</span>        <span class="comment">// We build the global T matrix and the g constant vector</span></div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>        TSystemMatrixType&amp; rTMatrix = *mpTMatrix;</div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span>        TSystemVectorType&amp; rConstantVector = *mpConstantVector;</div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span> </div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span>        <span class="comment">// Filling constant vector</span></div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span>        <span class="keywordflow">if</span> (ComputeConstantVector) {</div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span>            IndexPartition&lt;std::size_t&gt;(this-&gt;mEquationSystemSize).for_each([&amp;rConstantVector](std::size_t Index){</div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span>                rConstantVector[<a class="code hl_variable" href="../../da/dec/namespace_kratos_1_1_mortar_utilities.html#ab760d3f1c6c454fff50350af7ec2dc7a">Index</a>] = 0.0;</div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span>            });</div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span>        }</div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span> </div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>        <span class="comment">// Auxiliar set to reorder master DoFs</span></div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span>        IndexMapType solvable_dof_reorder;</div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span> </div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span>        <span class="comment">// Filling with &quot;ones&quot;</span></div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span>        <span class="keyword">typedef</span> std::pair&lt;IndexType, IndexType&gt; IndexIndexPairType;</div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span>        <a class="code hl_typedef" href="../../d5/d4d/group___kratos_core.html#ga1ba1e34f0af6a7cfcfa9b43e1f8e8c91">IndexType</a> <a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> = 0;</div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; dof : BaseType::mDofSet) {</div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/df2/namespaceode__solve.html#a3c949810f9da8ea09afa47003dedc1e3">dof</a>.EquationId() &lt; BaseType::mEquationSystemSize) {</div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/d4d/group___kratos_core.html#ga1ba1e34f0af6a7cfcfa9b43e1f8e8c91">IndexType</a> equation_id = <a class="code hl_variable" href="../../d2/df2/namespaceode__solve.html#a3c949810f9da8ea09afa47003dedc1e3">dof</a>.EquationId();</div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span>                <span class="keyword">auto</span> it = mDoFSlaveSet.find(dof);</div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span>                <span class="keywordflow">if</span> (it == mDoFSlaveSet.end()) {</div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span>                    solvable_dof_reorder.insert(IndexIndexPairType(equation_id, counter));</div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span>                    ++<a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>;</div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span>                }</div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>            }</div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>        }</div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span> </div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span>        <span class="comment">// The current process info</span></div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span>        <span class="keyword">const</span> <a class="code hl_enumvalue" href="../../db/d66/namespace_kratos.html#a1514eea722d243fa5561f7050c071b9fa72b048930550a0e11889dd0ac17b0439">ProcessInfo</a>&amp; r_current_process_info = <a class="code hl_variable" href="../../db/d91/namespace_kratos_1_1_rans_variable_utilities.html#a59c7e204dd415b212e4726b5e2bcbc82">rModelPart</a>.GetProcessInfo();</div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span> </div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>        <span class="comment">// Initialize the constant vector</span></div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span>        <span class="keywordtype">double</span> aux_constant_value = 0.0;</div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span> </div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>        <span class="comment">// Contributions to the system</span></div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>        LocalSystemMatrixType transformation_matrix = LocalSystemMatrixType(0, 0);</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span>        LocalSystemVectorType constant_vector = LocalSystemVectorType(0);</div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span> </div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span>        <span class="comment">// Vector containing the localization in the system of the different terms</span></div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span>        EquationIdVectorType slave_equation_id, master_equation_id;</div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span> </div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> number_of_constraints = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../db/d91/namespace_kratos_1_1_rans_variable_utilities.html#a59c7e204dd415b212e4726b5e2bcbc82">rModelPart</a>.MasterSlaveConstraints().size());</div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span> </div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span>        std::unordered_set&lt;IndexType&gt; auxiliar_constant_equations_ids;</div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span> </div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span><span class="preprocessor">        #pragma omp parallel firstprivate(transformation_matrix, constant_vector, slave_equation_id, master_equation_id)</span></div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span>        {</div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>            std::unordered_set&lt;IndexType&gt; auxiliar_temp_constant_equations_ids;</div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span>            auxiliar_temp_constant_equations_ids.reserve(2000);</div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span> </div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span><span class="preprocessor">            #pragma omp for schedule(guided, 512)</span></div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_const = 0; i_const &lt; number_of_constraints; ++i_const) {</div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span>                <span class="keyword">auto</span> it_const = <a class="code hl_variable" href="../../db/d91/namespace_kratos_1_1_rans_variable_utilities.html#a59c7e204dd415b212e4726b5e2bcbc82">rModelPart</a>.MasterSlaveConstraints().begin() + i_const;</div>
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"> 2133</span> </div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span>                <span class="comment">// Detect if the constraint is active or not. If the user did not make any choice the constraint</span></div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span>                <span class="comment">// It is active by default</span></div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span>                <span class="keywordtype">bool</span> constraint_is_active = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span>                <span class="keywordflow">if</span> (it_const-&gt;IsDefined(ACTIVE))</div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span>                    constraint_is_active = it_const-&gt;Is(ACTIVE);</div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span> </div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span>                <span class="keywordflow">if</span> (constraint_is_active) {</div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span>                    it_const-&gt;CalculateLocalSystem(transformation_matrix, constant_vector, r_current_process_info);</div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span>                    it_const-&gt;EquationIdVector(slave_equation_id, master_equation_id, r_current_process_info);</div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span> </div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>                    <span class="comment">// Reassign reordered dofs to the master side</span></div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <span class="keywordtype">id</span> : master_equation_id) {</div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span>                        <span class="keywordtype">id</span> = solvable_dof_reorder[id];</div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span>                    }</div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span> </div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span>                    <span class="keywordflow">if</span> (ComputeConstantVector) {</div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"> 2150</span>                        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/d4d/group___kratos_core.html#ga1ba1e34f0af6a7cfcfa9b43e1f8e8c91">IndexType</a> i = 0; <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; slave_equation_id.size(); ++<a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>) {</div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span>                            <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/d4d/group___kratos_core.html#ga1ba1e34f0af6a7cfcfa9b43e1f8e8c91">IndexType</a> i_global = slave_equation_id[<a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>];</div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span>                            <span class="keywordflow">if</span> (i_global &lt; BaseType::mEquationSystemSize) {</div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span>                                <span class="keyword">const</span> <span class="keywordtype">double</span> constant_value = constant_vector[<a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>];</div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span>                                <span class="keywordflow">if</span> (std::abs(constant_value) &gt; 0.0) {</div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span>                                    auxiliar_temp_constant_equations_ids.insert(i_global);</div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span>                                    <span class="keywordtype">double</span>&amp; r_value = rConstantVector[i_global];</div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span>                                    <a class="code hl_function" href="../../db/d66/namespace_kratos.html#a127b39e29fd77f2e39373d00dc48e571">AtomicAdd</a>(r_value, constant_value);</div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span>                                }</div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span>                            }</div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span>                        }</div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span>                        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/d4d/group___kratos_core.html#ga1ba1e34f0af6a7cfcfa9b43e1f8e8c91">IndexType</a> i = 0; <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; slave_equation_id.size(); ++<a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>) {</div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span>                            <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/d4d/group___kratos_core.html#ga1ba1e34f0af6a7cfcfa9b43e1f8e8c91">IndexType</a> i_global = slave_equation_id[<a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>];</div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span>                            <span class="keywordflow">if</span> (i_global &lt; BaseType::mEquationSystemSize) {</div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span>                                <span class="keyword">const</span> <span class="keywordtype">double</span> constant_value = constant_vector[<a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>];</div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span>                                <a class="code hl_function" href="../../db/d66/namespace_kratos.html#a127b39e29fd77f2e39373d00dc48e571">AtomicAdd</a>(aux_constant_value, std::abs(constant_value));</div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span>                            }</div>
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"> 2168</span>                        }</div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span>                    }</div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span> </div>
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"> 2171</span>                    <span class="keywordflow">if</span> (ComputeTranslationMatrix) {</div>
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"> 2172</span>                        <span class="comment">// Assemble the constraint contribution</span></div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span>                        AssembleRelationMatrix(rTMatrix, transformation_matrix, slave_equation_id, master_equation_id);</div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span>                    }</div>
<div class="line"><a id="l02175" name="l02175"></a><span class="lineno"> 2175</span>                }</div>
<div class="line"><a id="l02176" name="l02176"></a><span class="lineno"> 2176</span>            }</div>
<div class="line"><a id="l02177" name="l02177"></a><span class="lineno"> 2177</span> </div>
<div class="line"><a id="l02178" name="l02178"></a><span class="lineno"> 2178</span>            <span class="comment">// We merge all the sets in one thread</span></div>
<div class="line"><a id="l02179" name="l02179"></a><span class="lineno"> 2179</span><span class="preprocessor">            #pragma omp critical</span></div>
<div class="line"><a id="l02180" name="l02180"></a><span class="lineno"> 2180</span>            {</div>
<div class="line"><a id="l02181" name="l02181"></a><span class="lineno"> 2181</span>                auxiliar_constant_equations_ids.insert(auxiliar_temp_constant_equations_ids.begin(), auxiliar_temp_constant_equations_ids.end());</div>
<div class="line"><a id="l02182" name="l02182"></a><span class="lineno"> 2182</span>            }</div>
<div class="line"><a id="l02183" name="l02183"></a><span class="lineno"> 2183</span>        }</div>
<div class="line"><a id="l02184" name="l02184"></a><span class="lineno"> 2184</span> </div>
<div class="line"><a id="l02185" name="l02185"></a><span class="lineno"> 2185</span>        <span class="keywordflow">return</span> aux_constant_value &gt; std::numeric_limits&lt;double&gt;::epsilon() ? true : <span class="keyword">false</span>;</div>
<div class="line"><a id="l02186" name="l02186"></a><span class="lineno"> 2186</span> </div>
<div class="line"><a id="l02187" name="l02187"></a><span class="lineno"> 2187</span>        <a class="code hl_define" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l02188" name="l02188"></a><span class="lineno"> 2188</span>    }</div>
<div class="line"><a id="l02189" name="l02189"></a><span class="lineno"> 2189</span> </div>
<div class="line"><a id="l02196" name="l02196"></a><span class="lineno"> 2196</span>    <span class="keywordtype">void</span> ComputeEffectiveConstant(</div>
<div class="line"><a id="l02197" name="l02197"></a><span class="lineno"> 2197</span>        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a id="l02198" name="l02198"></a><span class="lineno"> 2198</span>        <a class="code hl_class" href="../../d4/d5e/class_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a id="l02199" name="l02199"></a><span class="lineno"> 2199</span>        TSystemVectorType&amp; rDxSolved</div>
<div class="line"><a id="l02200" name="l02200"></a><span class="lineno"> 2200</span>        )</div>
<div class="line"><a id="l02201" name="l02201"></a><span class="lineno"> 2201</span>    {</div>
<div class="line"><a id="l02202" name="l02202"></a><span class="lineno"> 2202</span>        <span class="keywordflow">if</span> (mComputeConstantContribution) {</div>
<div class="line"><a id="l02203" name="l02203"></a><span class="lineno"> 2203</span>            <span class="comment">// We get</span></div>
<div class="line"><a id="l02204" name="l02204"></a><span class="lineno"> 2204</span>            <span class="keyword">const</span> TSystemMatrixType&amp; rTMatrix = *mpTMatrix;</div>
<div class="line"><a id="l02205" name="l02205"></a><span class="lineno"> 2205</span>            TSystemVectorType&amp; rConstantVector = *mpConstantVector;</div>
<div class="line"><a id="l02206" name="l02206"></a><span class="lineno"> 2206</span>            TSystemVectorType&amp; rDeltaConstantVector = *mpDeltaConstantVector;</div>
<div class="line"><a id="l02207" name="l02207"></a><span class="lineno"> 2207</span>            TSparseSpace::Copy(rConstantVector, rDeltaConstantVector);</div>
<div class="line"><a id="l02208" name="l02208"></a><span class="lineno"> 2208</span> </div>
<div class="line"><a id="l02209" name="l02209"></a><span class="lineno"> 2209</span>            <span class="comment">// We reconstruct the complete vector of Unknowns</span></div>
<div class="line"><a id="l02210" name="l02210"></a><span class="lineno"> 2210</span>            TSystemVectorType Dx(BaseType::mEquationSystemSize);</div>
<div class="line"><a id="l02211" name="l02211"></a><span class="lineno"> 2211</span>            TSparseSpace::Mult(rTMatrix, rDxSolved, Dx);</div>
<div class="line"><a id="l02212" name="l02212"></a><span class="lineno"> 2212</span> </div>
<div class="line"><a id="l02213" name="l02213"></a><span class="lineno"> 2213</span>            <span class="comment">// Compute the effective constant vector</span></div>
<div class="line"><a id="l02214" name="l02214"></a><span class="lineno"> 2214</span>            <span class="comment">// Auxiliar initial dof iterator</span></div>
<div class="line"><a id="l02215" name="l02215"></a><span class="lineno"> 2215</span>            <span class="keyword">const</span> <span class="keyword">auto</span> it_dof_begin = BaseType::mDofSet.begin();</div>
<div class="line"><a id="l02216" name="l02216"></a><span class="lineno"> 2216</span> </div>
<div class="line"><a id="l02217" name="l02217"></a><span class="lineno"> 2217</span>            TSystemVectorType <a class="code hl_variable" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#adcabf3b15773ccd9b7cd71986b6a9b10">u</a>(BaseType::mEquationSystemSize);</div>
<div class="line"><a id="l02218" name="l02218"></a><span class="lineno"> 2218</span> </div>
<div class="line"><a id="l02219" name="l02219"></a><span class="lineno"> 2219</span>            <a class="code hl_function" href="../../db/d66/namespace_kratos.html#a07ef8a5b8886ded903a1e7ad4c0df960">block_for_each</a>(BaseType::mDofSet, [&amp;, <span class="keyword">this</span>](Dof&lt;double&gt;&amp; rDof){</div>
<div class="line"><a id="l02220" name="l02220"></a><span class="lineno"> 2220</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/d4d/group___kratos_core.html#ga1ba1e34f0af6a7cfcfa9b43e1f8e8c91">IndexType</a> equation_id = rDof.EquationId();</div>
<div class="line"><a id="l02221" name="l02221"></a><span class="lineno"> 2221</span>                <span class="keywordflow">if</span> (equation_id &lt; this-&gt;mEquationSystemSize ) {</div>
<div class="line"><a id="l02222" name="l02222"></a><span class="lineno"> 2222</span>                    <a class="code hl_variable" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#adcabf3b15773ccd9b7cd71986b6a9b10">u</a>[equation_id] = rDof.GetSolutionStepValue() + Dx[equation_id];</div>
<div class="line"><a id="l02223" name="l02223"></a><span class="lineno"> 2223</span>                }</div>
<div class="line"><a id="l02224" name="l02224"></a><span class="lineno"> 2224</span>            });</div>
<div class="line"><a id="l02225" name="l02225"></a><span class="lineno"> 2225</span> </div>
<div class="line"><a id="l02226" name="l02226"></a><span class="lineno"> 2226</span>            TSystemVectorType u_bar(mDoFToSolveSystemSize);</div>
<div class="line"><a id="l02227" name="l02227"></a><span class="lineno"> 2227</span>            <a class="code hl_typedef" href="../../d5/d4d/group___kratos_core.html#ga1ba1e34f0af6a7cfcfa9b43e1f8e8c91">IndexType</a> <a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> = 0;</div>
<div class="line"><a id="l02228" name="l02228"></a><span class="lineno"> 2228</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/d4d/group___kratos_core.html#ga1ba1e34f0af6a7cfcfa9b43e1f8e8c91">IndexType</a> i = 0; <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; BaseType::mDofSet.size(); ++<a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>) {</div>
<div class="line"><a id="l02229" name="l02229"></a><span class="lineno"> 2229</span>                <span class="keyword">auto</span> it_dof = it_dof_begin + <a class="code hl_variable" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>;</div>
<div class="line"><a id="l02230" name="l02230"></a><span class="lineno"> 2230</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/d4d/group___kratos_core.html#ga1ba1e34f0af6a7cfcfa9b43e1f8e8c91">IndexType</a> equation_id = it_dof-&gt;EquationId();</div>
<div class="line"><a id="l02231" name="l02231"></a><span class="lineno"> 2231</span>                <span class="keywordflow">if</span> (equation_id &lt; BaseType::mEquationSystemSize ) {</div>
<div class="line"><a id="l02232" name="l02232"></a><span class="lineno"> 2232</span> </div>
<div class="line"><a id="l02233" name="l02233"></a><span class="lineno"> 2233</span>                    <span class="keyword">auto</span> it = mDoFSlaveSet.find(*it_dof);</div>
<div class="line"><a id="l02234" name="l02234"></a><span class="lineno"> 2234</span>                    <span class="keywordflow">if</span> (it == mDoFSlaveSet.end()) {</div>
<div class="line"><a id="l02235" name="l02235"></a><span class="lineno"> 2235</span>                        u_bar[<a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>] = it_dof-&gt;GetSolutionStepValue() + rDxSolved[<a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>];</div>
<div class="line"><a id="l02236" name="l02236"></a><span class="lineno"> 2236</span>                        <a class="code hl_variable" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> += 1;</div>
<div class="line"><a id="l02237" name="l02237"></a><span class="lineno"> 2237</span>                    }</div>
<div class="line"><a id="l02238" name="l02238"></a><span class="lineno"> 2238</span>                }</div>
<div class="line"><a id="l02239" name="l02239"></a><span class="lineno"> 2239</span>            }</div>
<div class="line"><a id="l02240" name="l02240"></a><span class="lineno"> 2240</span>            TSystemVectorType u_bar_complete(BaseType::mEquationSystemSize);</div>
<div class="line"><a id="l02241" name="l02241"></a><span class="lineno"> 2241</span>            TSparseSpace::Mult(rTMatrix, u_bar, u_bar_complete);</div>
<div class="line"><a id="l02242" name="l02242"></a><span class="lineno"> 2242</span> </div>
<div class="line"><a id="l02243" name="l02243"></a><span class="lineno"> 2243</span>            TSparseSpace::UnaliasedAdd(rDeltaConstantVector, 1.0, u_bar_complete);</div>
<div class="line"><a id="l02244" name="l02244"></a><span class="lineno"> 2244</span>            TSparseSpace::UnaliasedAdd(rDeltaConstantVector, -1.0, u);</div>
<div class="line"><a id="l02245" name="l02245"></a><span class="lineno"> 2245</span>        }</div>
<div class="line"><a id="l02246" name="l02246"></a><span class="lineno"> 2246</span>    }</div>
<div class="line"><a id="l02247" name="l02247"></a><span class="lineno"> 2247</span> </div>
<div class="line"><a id="l02254" name="l02254"></a><span class="lineno"> 2254</span> </div>
<div class="line"><a id="l02258" name="l02258"></a><span class="lineno"> 2258</span> </div>
<div class="line"><a id="l02260" name="l02260"></a><span class="lineno"> 2260</span> </div>
<div class="line"><a id="l02261" name="l02261"></a><span class="lineno"> 2261</span>}; <span class="comment">/* Class ResidualBasedEliminationBuilderAndSolverWithConstraints */</span></div>
<div class="line"><a id="l02262" name="l02262"></a><span class="lineno"> 2262</span> </div>
<div class="line"><a id="l02264" name="l02264"></a><span class="lineno"> 2264</span> </div>
<div class="line"><a id="l02267" name="l02267"></a><span class="lineno"> 2267</span> </div>
<div class="line"><a id="l02269" name="l02269"></a><span class="lineno"> 2269</span> </div>
<div class="line"><a id="l02270" name="l02270"></a><span class="lineno"> 2270</span>} <span class="comment">/* namespace Kratos.*/</span></div>
<div class="line"><a id="l02271" name="l02271"></a><span class="lineno"> 2271</span> </div>
<div class="line"><a id="l02272" name="l02272"></a><span class="lineno"> 2272</span><span class="preprocessor">#endif </span><span class="comment">/* KRATOS_RESIDUAL_BASED_BLOCK_BUILDER_AND_SOLVER  defined */</span><span class="preprocessor"></span></div>
<div class="ttc" id="abuiltin__timer_8h_html"><div class="ttname"><a href="../../df/d21/builtin__timer_8h.html">builtin_timer.h</a></div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html">Kratos::BuilderAndSolver</a></div><div class="ttdoc">Current class provides an implementation for the base builder and solving operations.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:64</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_a22231ac6816fd743908f9601bd8ba6a5"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a22231ac6816fd743908f9601bd8ba6a5">Kratos::BuilderAndSolver::mDofSetIsInitialized</a></div><div class="ttdeci">bool mDofSetIsInitialized</div><div class="ttdoc">If the matrix is reshaped each step.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:743</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_a4960cb64a0657894f9776608a923ce25"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4960cb64a0657894f9776608a923ce25">Kratos::BuilderAndSolver::GetCalculateReactionsFlag</a></div><div class="ttdeci">bool GetCalculateReactionsFlag() const</div><div class="ttdoc">This method returns the flag mCalculateReactionsFlag.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:184</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_a77fcbfce08aab91bcb13400df7b1d401"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a77fcbfce08aab91bcb13400df7b1d401">Kratos::BuilderAndSolver::mpReactionsVector</a></div><div class="ttdeci">TSystemVectorPointerType mpReactionsVector</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:751</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_a820ea37407f3fbd75d827ccbfdc0e963"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a820ea37407f3fbd75d827ccbfdc0e963">Kratos::BuilderAndSolver::ValidateAndAssignParameters</a></div><div class="ttdeci">virtual Parameters ValidateAndAssignParameters(Parameters ThisParameters, const Parameters DefaultParameters) const</div><div class="ttdoc">This method validate and assign default parameters.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:767</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_aa4cf0a493c34278ce36248b94ffc7247"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#aa4cf0a493c34278ce36248b94ffc7247">Kratos::BuilderAndSolver::GetReshapeMatrixFlag</a></div><div class="ttdeci">bool GetReshapeMatrixFlag() const</div><div class="ttdoc">This method returns the flag mReshapeMatrixFlag.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:220</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ab506043e71e90f54eb7ea575db79550a"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab506043e71e90f54eb7ea575db79550a">Kratos::BuilderAndSolver::mpLinearSystemSolver</a></div><div class="ttdeci">TLinearSolver::Pointer mpLinearSystemSolver</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:737</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ac263566ea01f7fd5b200597bd0d94f8a"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">Kratos::BuilderAndSolver::mDofSet</a></div><div class="ttdeci">DofsArrayType mDofSet</div><div class="ttdoc">Pointer to the linear solver.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:739</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_adf722c4e501d8e245fc554bd97beab1d"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#adf722c4e501d8e245fc554bd97beab1d">Kratos::BuilderAndSolver::mCalculateReactionsFlag</a></div><div class="ttdeci">bool mCalculateReactionsFlag</div><div class="ttdoc">Flag taking care if the dof set was initialized ot not.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:745</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ae123013335a4ece0d8fdc5c701c75ae2"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">Kratos::BuilderAndSolver::GetEchoLevel</a></div><div class="ttdeci">int GetEchoLevel() const</div><div class="ttdoc">It returns the echo level.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:674</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ae638e6890872c910b6e087d97bc7d0bd"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">Kratos::BuilderAndSolver::mEquationSystemSize</a></div><div class="ttdeci">unsigned int mEquationSystemSize</div><div class="ttdoc">Flag taking in account if it is needed or not to calculate the reactions.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:747</div></div>
<div class="ttc" id="aclass_kratos_1_1_builtin_timer_html"><div class="ttname"><a href="../../d3/d5a/class_kratos_1_1_builtin_timer.html">Kratos::BuiltinTimer</a></div><div class="ttdef"><b>Definition:</b> builtin_timer.h:27</div></div>
<div class="ttc" id="aclass_kratos_1_1_dof_html"><div class="ttname"><a href="../../dc/d58/class_kratos_1_1_dof.html">Kratos::Dof</a></div><div class="ttdoc">Dof represents a degree of freedom (DoF).</div><div class="ttdef"><b>Definition:</b> dof.h:88</div></div>
<div class="ttc" id="aclass_kratos_1_1_element_html_a83ae9b09dd7a0ed7ab3bc1baa6429df5"><div class="ttname"><a href="../../d5/dd4/class_kratos_1_1_element.html#a83ae9b09dd7a0ed7ab3bc1baa6429df5">Kratos::Element::DofsVectorType</a></div><div class="ttdeci">std::vector&lt; DofType::Pointer &gt; DofsVectorType</div><div class="ttdef"><b>Definition:</b> element.h:100</div></div>
<div class="ttc" id="aclass_kratos_1_1_element_html_ae71a1a55ae484b69ec9ec5f18919e324"><div class="ttname"><a href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Kratos::Element::EquationIdVectorType</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; EquationIdVectorType</div><div class="ttdef"><b>Definition:</b> element.h:98</div></div>
<div class="ttc" id="aclass_kratos_1_1_index_partition_html"><div class="ttname"><a href="../../d9/d9b/class_kratos_1_1_index_partition.html">Kratos::IndexPartition</a></div><div class="ttdoc">This class is useful for index iteration over containers.</div><div class="ttdef"><b>Definition:</b> parallel_utilities.h:351</div></div>
<div class="ttc" id="aclass_kratos_1_1_index_partition_html_af1ce67064923939c2a8a0172cdb5e344"><div class="ttname"><a href="../../d9/d9b/class_kratos_1_1_index_partition.html#af1ce67064923939c2a8a0172cdb5e344">Kratos::IndexPartition::for_each</a></div><div class="ttdeci">void for_each(TUnaryFunction &amp;&amp;f)</div><div class="ttdef"><b>Definition:</b> parallel_utilities.h:416</div></div>
<div class="ttc" id="aclass_kratos_1_1_internals_1_1_matrix_html"><div class="ttname"><a href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">Kratos::Internals::Matrix&lt; double, AMatrix::dynamic, 1 &gt;</a></div></div>
<div class="ttc" id="aclass_kratos_1_1_internals_1_1_matrix_html_a3d36c583d63e7eeda493a7abdc97d874"><div class="ttname"><a href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html#a3d36c583d63e7eeda493a7abdc97d874">Kratos::Internals::Matrix::resize</a></div><div class="ttdeci">void resize(std::size_t NewSize1, std::size_t NewSize2, bool preserve=0)</div><div class="ttdef"><b>Definition:</b> amatrix_interface.h:224</div></div>
<div class="ttc" id="aclass_kratos_1_1_master_slave_constraint_html"><div class="ttname"><a href="../../de/d16/class_kratos_1_1_master_slave_constraint.html">Kratos::MasterSlaveConstraint</a></div><div class="ttdoc">A class that implements the interface for different master-slave constraints to be applied on a syste...</div><div class="ttdef"><b>Definition:</b> master_slave_constraint.h:78</div></div>
<div class="ttc" id="aclass_kratos_1_1_node_html"><div class="ttname"><a href="../../d5/ddd/class_kratos_1_1_node.html">Kratos::Node</a></div><div class="ttdoc">This class defines the node.</div><div class="ttdef"><b>Definition:</b> node.h:74</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">Kratos::PointerVectorSet</a></div><div class="ttdoc">PointerVectorSet is a sorted associative container like stl set but using a vector to store pointers ...</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:72</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html">Kratos::ResidualBasedEliminationBuilderAndSolver</a></div><div class="ttdoc">Current class provides an implementation for standard elimination builder and solving operations.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:76</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a367a8cb17bb56e6b5fdc272b40aff1d3"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a367a8cb17bb56e6b5fdc272b40aff1d3">Kratos::ResidualBasedEliminationBuilderAndSolver::BuildRHS</a></div><div class="ttdeci">void BuildRHS(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemVectorType &amp;rb) override</div><div class="ttdoc">Function to perform the build of the RHS.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:596</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a3f0006d49a686647dc9e7e35e5b1cf85"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a3f0006d49a686647dc9e7e35e5b1cf85">Kratos::ResidualBasedEliminationBuilderAndSolver::AssembleRowContributionFreeDofs</a></div><div class="ttdeci">void AssembleRowContributionFreeDofs(TSystemMatrixType &amp;rA, const Matrix &amp;rALocal, const IndexType i, const IndexType i_local, const Element::EquationIdVectorType &amp;EquationId)</div><div class="ttdoc">This function is equivalent to the AssembleRowContribution of the block builder and solver.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:1259</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a4035089c8a396ae112ec54e02a7ef407"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a4035089c8a396ae112ec54e02a7ef407">Kratos::ResidualBasedEliminationBuilderAndSolver::TSystemMatrixPointerType</a></div><div class="ttdeci">BaseType::TSystemMatrixPointerType TSystemMatrixPointerType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:100</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a46805f895498d8eb4e85dc8b8d6deb7e"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a46805f895498d8eb4e85dc8b8d6deb7e">Kratos::ResidualBasedEliminationBuilderAndSolver::BuildAndSolve</a></div><div class="ttdeci">void BuildAndSolve(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;rA, TSystemVectorType &amp;rDx, TSystemVectorType &amp;rb) override</div><div class="ttdoc">Function to perform the building and solving phase at the same time.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:531</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a4706ad414b53ff8cb629ee2e8e4860d4"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a4706ad414b53ff8cb629ee2e8e4860d4">Kratos::ResidualBasedEliminationBuilderAndSolver::TSystemVectorPointerType</a></div><div class="ttdeci">BaseType::TSystemVectorPointerType TSystemVectorPointerType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:101</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a4a6fe7f24463750985fb1e7967892cc6"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a4a6fe7f24463750985fb1e7967892cc6">Kratos::ResidualBasedEliminationBuilderAndSolver::Build</a></div><div class="ttdeci">void Build(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;rA, TSystemVectorType &amp;rb) override</div><div class="ttdoc">Function to perform the build of the RHS. The vector could be sized as the total number of dofs or as...</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:184</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a723a76a8797ffc71e7518f5a2008f54a"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a723a76a8797ffc71e7518f5a2008f54a">Kratos::ResidualBasedEliminationBuilderAndSolver::ResizeAndInitializeVectors</a></div><div class="ttdeci">void ResizeAndInitializeVectors(typename TSchemeType::Pointer pScheme, TSystemMatrixPointerType &amp;pA, TSystemVectorPointerType &amp;pDx, TSystemVectorPointerType &amp;pb, ModelPart &amp;rModelPart) override</div><div class="ttdoc">This method resize and initializes the system of euqations.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:820</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a74c5805cee1dce8db5969a4cb0b6c501"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a74c5805cee1dce8db5969a4cb0b6c501">Kratos::ResidualBasedEliminationBuilderAndSolver::TDataType</a></div><div class="ttdeci">BaseType::TDataType TDataType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:94</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a7a5ab35c93a40a75aaaf8f65e905d56e"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a7a5ab35c93a40a75aaaf8f65e905d56e">Kratos::ResidualBasedEliminationBuilderAndSolver::TSystemVectorType</a></div><div class="ttdeci">BaseType::TSystemVectorType TSystemVectorType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:97</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a85c1ea369d1431be0b121442079b08f1"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a85c1ea369d1431be0b121442079b08f1">Kratos::ResidualBasedEliminationBuilderAndSolver::LocalSystemVectorType</a></div><div class="ttdeci">BaseType::LocalSystemVectorType LocalSystemVectorType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:98</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a93eda0de27465af0565ff64131eaeece"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a93eda0de27465af0565ff64131eaeece">Kratos::ResidualBasedEliminationBuilderAndSolver::GetDefaultParameters</a></div><div class="ttdeci">Parameters GetDefaultParameters() const override</div><div class="ttdoc">This method provides the defaults parameters to avoid conflicts between the different constructors.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:974</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a960c1b82952e6af3c87cb7c25bb7d77d"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a960c1b82952e6af3c87cb7c25bb7d77d">Kratos::ResidualBasedEliminationBuilderAndSolver::DofsArrayType</a></div><div class="ttdeci">BaseType::DofsArrayType DofsArrayType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:95</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a9ecc52fbc0a127e2d771b889af2360b3"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a9ecc52fbc0a127e2d771b889af2360b3">Kratos::ResidualBasedEliminationBuilderAndSolver::SetUpDofSet</a></div><div class="ttdeci">void SetUpDofSet(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart) override</div><div class="ttdoc">Builds the list of the DofSets involved in the problem by &quot;asking&quot; to each element and condition its ...</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:678</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_a9f7606fca28422b0a30802b55229c46b"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#a9f7606fca28422b0a30802b55229c46b">Kratos::ResidualBasedEliminationBuilderAndSolver::LocalSystemMatrixType</a></div><div class="ttdeci">BaseType::LocalSystemMatrixType LocalSystemMatrixType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:99</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_aa26494df4a0104218d26dcaa471f34a1"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#aa26494df4a0104218d26dcaa471f34a1">Kratos::ResidualBasedEliminationBuilderAndSolver::NodesArrayType</a></div><div class="ttdeci">BaseType::NodesArrayType NodesArrayType</div><div class="ttdoc">Containers definition.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:111</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_aa6626f76a94936e5a6e6f08b98eeb6eb"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#aa6626f76a94936e5a6e6f08b98eeb6eb">Kratos::ResidualBasedEliminationBuilderAndSolver::ConditionsArrayType</a></div><div class="ttdeci">BaseType::ConditionsArrayType ConditionsArrayType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:113</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_abe16593f21409370809c981420bd56fc"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#abe16593f21409370809c981420bd56fc">Kratos::ResidualBasedEliminationBuilderAndSolver::Clear</a></div><div class="ttdeci">void Clear() override</div><div class="ttdoc">This function is intended to be called at the end of the solution step to clean up memory storage not...</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:944</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_acae2dc76ff211019362a883c883159e0"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#acae2dc76ff211019362a883c883159e0">Kratos::ResidualBasedEliminationBuilderAndSolver::ElementsArrayType</a></div><div class="ttdeci">BaseType::ElementsArrayType ElementsArrayType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:112</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_ae09b93cc9b819ea302667f8e0e54aa9a"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#ae09b93cc9b819ea302667f8e0e54aa9a">Kratos::ResidualBasedEliminationBuilderAndSolver::AssignSettings</a></div><div class="ttdeci">void AssignSettings(const Parameters ThisParameters) override</div><div class="ttdoc">This method assigns settings to member variables.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:1346</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_ae4fae7e104dd4d490437cbd3ca36667c"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#ae4fae7e104dd4d490437cbd3ca36667c">Kratos::ResidualBasedEliminationBuilderAndSolver::ConstructMatrixStructure</a></div><div class="ttdeci">virtual void ConstructMatrixStructure(typename TSchemeType::Pointer pScheme, TSystemMatrixType &amp;rA, ModelPart &amp;rModelPart)</div><div class="ttdoc">This method constructs the relationship between the DoF.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:1110</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_af66148cdea4b95987036ab66a7acc4c5"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#af66148cdea4b95987036ab66a7acc4c5">Kratos::ResidualBasedEliminationBuilderAndSolver::TSystemMatrixType</a></div><div class="ttdeci">BaseType::TSystemMatrixType TSystemMatrixType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:96</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_html_af89b687ff19d88b5050236c7afd29daa"><div class="ttname"><a href="../../dd/d76/class_kratos_1_1_residual_based_elimination_builder_and_solver.html#af89b687ff19d88b5050236c7afd29daa">Kratos::ResidualBasedEliminationBuilderAndSolver::SetUpSystem</a></div><div class="ttdeci">void SetUpSystem(ModelPart &amp;rModelPart) override</div><div class="ttdoc">Organises the dofset in order to speed up the building phase.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver.h:791</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints</a></div><div class="ttdoc">Current class provides an implementation for standard builder and solving operations.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:93</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a02834840a6ce4afcbeeb37ab16b34f17"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a02834840a6ce4afcbeeb37ab16b34f17">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::BuildRHS</a></div><div class="ttdeci">void BuildRHS(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemVectorType &amp;b) override</div><div class="ttdoc">Function to perform the build of the RHS.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:278</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a05394c1bffbd485c9e7b6c206d1efd75"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a05394c1bffbd485c9e7b6c206d1efd75">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::ResidualBasedEliminationBuilderAndSolverWithConstraints</a></div><div class="ttdeci">ResidualBasedEliminationBuilderAndSolverWithConstraints(typename TLinearSolver::Pointer pNewLinearSystemSolver, Parameters ThisParameters)</div><div class="ttdoc">Default constructor. (with parameters)</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:169</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a0ab5940c81ac46fb3b6f722b21ce4e86"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a0ab5940c81ac46fb3b6f722b21ce4e86">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::Build</a></div><div class="ttdeci">void Build(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;rA, TSystemVectorType &amp;rb) override</div><div class="ttdoc">Function to perform the build of the RHS. The vector could be sized as the total number of dofs or as...</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:236</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a0adb21d2fd429647bc6bbef5df7019ec"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a0adb21d2fd429647bc6bbef5df7019ec">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::ElementsContainerType</a></div><div class="ttdeci">PointerVectorSet&lt; Element, IndexedObject &gt; ElementsContainerType</div><div class="ttdoc">Additional definitions.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:130</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a0bf04191d0f57789d7b4a2b7560c8159"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a0bf04191d0f57789d7b4a2b7560c8159">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::BuildAndSolve</a></div><div class="ttdeci">void BuildAndSolve(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;A, TSystemVectorType &amp;Dx, TSystemVectorType &amp;b) override</div><div class="ttdoc">Function to perform the building and solving phase at the same time.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:259</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a0d58adcced056c9bd2a1869916701ad2"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a0d58adcced056c9bd2a1869916701ad2">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::MasterSlaveConstraintPointerType</a></div><div class="ttdeci">MasterSlaveConstraint::Pointer MasterSlaveConstraintPointerType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:147</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a101f070f1d8be296f48984c537236a38"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a101f070f1d8be296f48984c537236a38">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::CompressedMatrixType</a></div><div class="ttdeci">boost::numeric::ublas::compressed_matrix&lt; double &gt; CompressedMatrixType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:133</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a102418188ba27c6558d32d9811c7d6b2"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a102418188ba27c6558d32d9811c7d6b2">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::VectorType</a></div><div class="ttdeci">Vector VectorType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:149</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a14a1cf543f739e81d992df895873fe34"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a14a1cf543f739e81d992df895873fe34">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::EquationIdVectorType</a></div><div class="ttdeci">Element::EquationIdVectorType EquationIdVectorType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:131</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a18f60d6a438dfad5a8353faab17d3391"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a18f60d6a438dfad5a8353faab17d3391">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::SetUpDofSet</a></div><div class="ttdeci">void SetUpDofSet(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart) override</div><div class="ttdoc">Builds the list of the DofSets involved in the problem by &quot;asking&quot; to each element and condition its ...</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:302</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a1d943dfb964e12f7bd19976521fcb700"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a1d943dfb964e12f7bd19976521fcb700">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::mComputeConstantContribution</a></div><div class="ttdeci">bool mComputeConstantContribution</div><div class="ttdoc">If we reset the relation matrix at each iteration.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:396</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a211319895a1d41183d7f7768223fc3c3"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a211319895a1d41183d7f7768223fc3c3">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::BuildWithConstraints</a></div><div class="ttdeci">void BuildWithConstraints(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;rA, TSystemVectorType &amp;rb, const bool UseBaseBuild=true)</div><div class="ttdoc">This function is exactly same as the Build() function in base class except that the function.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:1078</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a236305006a4abafe3176624f9c74d1c3"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a236305006a4abafe3176624f9c74d1c3">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::ConstructMatrixStructure</a></div><div class="ttdeci">void ConstructMatrixStructure(typename TSchemeType::Pointer pScheme, TSystemMatrixType &amp;rA, ModelPart &amp;rModelPart) override</div><div class="ttdoc">This method constructs the relationship between the DoF.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:438</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a27d137182d319891edae86abe9091ee5"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a27d137182d319891edae86abe9091ee5">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::TSystemMatrixPointerType</a></div><div class="ttdeci">BaseType::TSystemMatrixPointerType TSystemMatrixPointerType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:122</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a2bd788b6b620698f7f9799898da92a08"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2bd788b6b620698f7f9799898da92a08">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::IndexSetType</a></div><div class="ttdeci">std::unordered_set&lt; IndexType &gt; IndexSetType</div><div class="ttdoc">Set definition.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:140</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a2cb4b9f2b5a37e05e21648ae80a65f52"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2cb4b9f2b5a37e05e21648ae80a65f52">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::mCheckConstraintRelation</a></div><div class="ttdeci">bool mCheckConstraintRelation</div><div class="ttdoc">In order to know the corresponding EquaionId for each component of the reaction vector.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:393</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a2d1139b0c2844483362d84110491c7e8"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a2d1139b0c2844483362d84110491c7e8">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::BuildRHSNoDirichlet</a></div><div class="ttdeci">void BuildRHSNoDirichlet(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemVectorType &amp;rb)</div><div class="ttdoc">Function to perform the build of the RHS.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:1159</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a30728020745e1f63faad9e64e2a735ff"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a30728020745e1f63faad9e64e2a735ff">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::DofPointerType</a></div><div class="ttdeci">DofType::Pointer DofPointerType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:137</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a30dcd2dbd25f060646de4cf210059138"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a30dcd2dbd25f060646de4cf210059138">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::ClassType</a></div><div class="ttdeci">ResidualBasedEliminationBuilderAndSolverWithConstraints&lt; TSparseSpace, TDenseSpace, TLinearSolver &gt; ClassType</div><div class="ttdoc">The definition of the current class.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:108</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a34593b03e0bcbad3dbf51ccb1b59c4eb"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a34593b03e0bcbad3dbf51ccb1b59c4eb">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::TDataType</a></div><div class="ttdeci">BaseType::TDataType TDataType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:116</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a362da1a9096633a8b701a94b97686e83"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a362da1a9096633a8b701a94b97686e83">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::MasterSlaveConstraintType</a></div><div class="ttdeci">MasterSlaveConstraint MasterSlaveConstraintType</div><div class="ttdoc">MPC definitions.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:146</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a3ef8d55c96702d9cb9d13724070c3b97"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a3ef8d55c96702d9cb9d13724070c3b97">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::ApplyDirichletConditions</a></div><div class="ttdeci">void ApplyDirichletConditions(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;rA, TSystemVectorType &amp;rDx, TSystemVectorType &amp;rb) override</div><div class="ttdoc">Applies the dirichlet conditions. This operation may be very heavy or completely unexpensive dependin...</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:1350</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a406c25b581ba183f82bd72afedb6339c"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a406c25b581ba183f82bd72afedb6339c">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::ResidualBasedEliminationBuilderAndSolverWithConstraints</a></div><div class="ttdeci">ResidualBasedEliminationBuilderAndSolverWithConstraints()</div><div class="ttdoc">Default constructor.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:162</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a4214dcba4525bf5586d688f03f464d9d"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a4214dcba4525bf5586d688f03f464d9d">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::NodesArrayType</a></div><div class="ttdeci">BaseType::NodesArrayType NodesArrayType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:125</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a428ff44448da78ec23c238b82977375b"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a428ff44448da78ec23c238b82977375b">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::mCleared</a></div><div class="ttdeci">bool mCleared</div><div class="ttdoc">If we compute the constant contribution of the MPC.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:397</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a43743c82a3e85fe4faa9f6a944b04805"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a43743c82a3e85fe4faa9f6a944b04805">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::SetUpSystem</a></div><div class="ttdeci">void SetUpSystem(ModelPart &amp;rModelPart) override</div><div class="ttdoc">Organises the dofset in order to speed up the building phase.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:220</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a45cc985b9e9eb40ed8337f0c70f29cbe"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a45cc985b9e9eb40ed8337f0c70f29cbe">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::ConditionsArrayType</a></div><div class="ttdeci">BaseType::ConditionsArrayType ConditionsArrayType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:127</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a4619d0acc5fb54213ce59009ea868868"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a4619d0acc5fb54213ce59009ea868868">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::Clear</a></div><div class="ttdeci">void Clear() override</div><div class="ttdoc">This function is intended to be called at the end of the solution step to clean up memory storage not...</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:1439</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a4757f6a4bfb8f4a10b2c6d5a8c55d907"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a4757f6a4bfb8f4a10b2c6d5a8c55d907">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::ElementsArrayType</a></div><div class="ttdeci">BaseType::ElementsArrayType ElementsArrayType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:126</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a5bc211023f9e20b6862f19175dfac73d"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a5bc211023f9e20b6862f19175dfac73d">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::DofsVectorType</a></div><div class="ttdeci">Element::DofsVectorType DofsVectorType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:132</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a62c8f9bcb97763c4865a06a3fd0c41a6"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a62c8f9bcb97763c4865a06a3fd0c41a6">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::TSystemVectorType</a></div><div class="ttdeci">BaseType::TSystemVectorType TSystemVectorType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:119</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a67894a891878fdd7e9ae301ab8fb1f6b"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a67894a891878fdd7e9ae301ab8fb1f6b">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::ResidualBasedEliminationBuilderAndSolverWithConstraints</a></div><div class="ttdeci">ResidualBasedEliminationBuilderAndSolverWithConstraints(typename TLinearSolver::Pointer pNewLinearSystemSolver, const bool CheckConstraintRelation=true, const bool ResetRelationMatrixEachIteration=false)</div><div class="ttdoc">Default constructor.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:182</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a68a996b72c2d643c49db01f8d5f8cea6"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a68a996b72c2d643c49db01f8d5f8cea6">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::mResetRelationMatrixEachIteration</a></div><div class="ttdeci">bool mResetRelationMatrixEachIteration</div><div class="ttdoc">If we do a constraint check relation.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:394</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a699f63c2cd6ad28f85d4d7887960abfd"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a699f63c2cd6ad28f85d4d7887960abfd">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::mpOldAMatrix</a></div><div class="ttdeci">TSystemMatrixPointerType mpOldAMatrix</div><div class="ttdoc">This is matrix containing the global relation for the constraints.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:385</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a6aa73dd0b771e56c1071631b86eb1f6e"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6aa73dd0b771e56c1071631b86eb1f6e">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::ResizeAndInitializeVectors</a></div><div class="ttdeci">void ResizeAndInitializeVectors(typename TSchemeType::Pointer pScheme, TSystemMatrixPointerType &amp;pA, TSystemVectorPointerType &amp;pDx, TSystemVectorPointerType &amp;pb, ModelPart &amp;rModelPart) override</div><div class="ttdoc">This method resize and initializes the system of euqations.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:1226</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a6aed94fbf245f3cf68d79c5171a68f94"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6aed94fbf245f3cf68d79c5171a68f94">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::LocalSystemMatrixType</a></div><div class="ttdeci">BaseType::LocalSystemMatrixType LocalSystemMatrixType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:121</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a6b456ab531be4a6fa894797833b144f7"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6b456ab531be4a6fa894797833b144f7">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::SystemSolveWithPhysics</a></div><div class="ttdeci">void SystemSolveWithPhysics(TSystemMatrixType &amp;rA, TSystemVectorType &amp;rDx, TSystemVectorType &amp;rb, ModelPart &amp;rModelPart)</div><div class="ttdoc">This is a call to the linear system solver (taking into account some physical particularities of the ...</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:725</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a6b5ea5ca519121ad054d0d6d0b42409a"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6b5ea5ca519121ad054d0d6d0b42409a">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::KRATOS_CLASS_POINTER_DEFINITION</a></div><div class="ttdeci">KRATOS_CLASS_POINTER_DEFINITION(ResidualBasedEliminationBuilderAndSolverWithConstraints)</div><div class="ttdoc">Pointer definition of ResidualBasedEliminationBuilderAndSolverWithConstraints.</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a6bcb2dbd5956d0ea25d821bc69130f76"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6bcb2dbd5956d0ea25d821bc69130f76">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::BaseType</a></div><div class="ttdeci">ResidualBasedEliminationBuilderAndSolver&lt; TSparseSpace, TDenseSpace, TLinearSolver &gt; BaseType</div><div class="ttdoc">Definition of the base class.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:105</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a6c5edc52cffcb3a5c9a33fa2f1b1a7ac"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6c5edc52cffcb3a5c9a33fa2f1b1a7ac">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::IndexMapType</a></div><div class="ttdeci">std::unordered_map&lt; IndexType, IndexType &gt; IndexMapType</div><div class="ttdoc">Map definition.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:143</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a6de07745e33ac5b8bf3bcc69abdd1cde"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6de07745e33ac5b8bf3bcc69abdd1cde">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::mDoFMasterFixedSet</a></div><div class="ttdeci">DofsArrayType mDoFMasterFixedSet</div><div class="ttdoc">This is vector contains the effective constant displacement.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:388</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a6e174804285252cb759c0bbd47a857ea"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6e174804285252cb759c0bbd47a857ea">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::CalculateReactions</a></div><div class="ttdeci">void CalculateReactions(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;rA, TSystemVectorType &amp;rDx, TSystemVectorType &amp;rb) override</div><div class="ttdoc">It computes the reactions of the system.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:1315</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a6fa2c27092cb81a5f1298b6f3c1c30c0"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a6fa2c27092cb81a5f1298b6f3c1c30c0">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::IndexType</a></div><div class="ttdeci">std::size_t IndexType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:112</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a85bf823ea9d90b6a55b12b9668fcbd20"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a85bf823ea9d90b6a55b12b9668fcbd20">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::TSchemeType</a></div><div class="ttdeci">BaseType::TSchemeType TSchemeType</div><div class="ttdoc">Definition of the classes from the base class.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:115</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a89ef3f2d3ae4a2d0e5d65ce96c5810ae"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a89ef3f2d3ae4a2d0e5d65ce96c5810ae">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::mpDeltaConstantVector</a></div><div class="ttdeci">TSystemVectorPointerType mpDeltaConstantVector</div><div class="ttdoc">This is vector containing the rigid movement of the constraint.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:387</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a94de53e688505f1a9969fd3c17a1db05"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a94de53e688505f1a9969fd3c17a1db05">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::mDoFToSolveSystemSize</a></div><div class="ttdeci">SizeType mDoFToSolveSystemSize</div><div class="ttdoc">The set containing the slave DoF of the system.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:390</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a981feaa7415d6863fda6c6248a6cebfa"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a981feaa7415d6863fda6c6248a6cebfa">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::ConstructMatrixStructureWithConstraints</a></div><div class="ttdeci">virtual void ConstructMatrixStructureWithConstraints(typename TSchemeType::Pointer pScheme, TSystemMatrixType &amp;rA, ModelPart &amp;rModelPart)</div><div class="ttdoc">This function is exactly same as the ConstructMatrixStructure() function in base class except that th...</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:777</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a98465de01df1164bd1415d5bf7a4d846"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a98465de01df1164bd1415d5bf7a4d846">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::AssembleRelationMatrix</a></div><div class="ttdeci">void AssembleRelationMatrix(TSystemMatrixType &amp;rT, const LocalSystemMatrixType &amp;rTransformationMatrix, const EquationIdVectorType &amp;rSlaveEquationId, const EquationIdVectorType &amp;rMasterEquationId)</div><div class="ttdoc">This method assembles the global relation matrix (T matrix used to impose the MPC)</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:414</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a9bb2ac99487e72759222b73bffcc7b33"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a9bb2ac99487e72759222b73bffcc7b33">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::Create</a></div><div class="ttdeci">BuilderAndSolverBaseType::Pointer Create(typename TLinearSolver::Pointer pNewLinearSystemSolver, Parameters ThisParameters) const override</div><div class="ttdoc">Create method.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:204</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_a9ee1f8a0625fa03bd6c86071d0d7897e"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#a9ee1f8a0625fa03bd6c86071d0d7897e">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::BuilderAndSolverBaseType</a></div><div class="ttdeci">BuilderAndSolver&lt; TSparseSpace, TDenseSpace, TLinearSolver &gt; BuilderAndSolverBaseType</div><div class="ttdoc">Definition of the base class.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:102</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_aa1bf3dee15b6ccf2460a3d4862ef4342"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa1bf3dee15b6ccf2460a3d4862ef4342">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::PrintInfo</a></div><div class="ttdeci">void PrintInfo(std::ostream &amp;rOStream) const override</div><div class="ttdoc">Print information about this object.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:360</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_aa4b7f1b56b2105c014ee2da71b257149"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa4b7f1b56b2105c014ee2da71b257149">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::mpTMatrix</a></div><div class="ttdeci">TSystemMatrixPointerType mpTMatrix</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:384</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_aa6b6778fe849c5e5eed2f973465b01b5"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aa6b6778fe849c5e5eed2f973465b01b5">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::mDoFSlaveSet</a></div><div class="ttdeci">DofsArrayType mDoFSlaveSet</div><div class="ttdoc">The set containing the fixed master DoF of the system.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:389</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_aaad19ea5b5d84c24e3b2b6bb22bb7346"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aaad19ea5b5d84c24e3b2b6bb22bb7346">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::mpConstantVector</a></div><div class="ttdeci">TSystemVectorPointerType mpConstantVector</div><div class="ttdoc">This is matrix containing the old LHS structure.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:386</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_aad67015d1cdd20517f93fce3556c6d81"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aad67015d1cdd20517f93fce3556c6d81">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::NodeType</a></div><div class="ttdeci">BaseType::NodeType NodeType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:124</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_ab28f7b143a3316b131c8ed154670fc12"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab28f7b143a3316b131c8ed154670fc12">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::DofType</a></div><div class="ttdeci">NodeType::DofType DofType</div><div class="ttdoc">DoF types definition.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:136</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_ab40e00db8fbfa9f3961ae1e47216443d"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab40e00db8fbfa9f3961ae1e47216443d">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::GetDefaultParameters</a></div><div class="ttdeci">Parameters GetDefaultParameters() const override</div><div class="ttdoc">This method provides the defaults parameters to avoid conflicts between the different constructors.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:317</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_ab67cb7c7d40bea63853df126c770541d"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab67cb7c7d40bea63853df126c770541d">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::mReactionEquationIdMap</a></div><div class="ttdeci">IndexMapType mReactionEquationIdMap</div><div class="ttdoc">Number of degrees of freedom of the problem to actually be solved.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:391</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_ab96c33010353414ca9fe9938d3705e64"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab96c33010353414ca9fe9938d3705e64">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::ConstructRelationMatrixStructure</a></div><div class="ttdeci">virtual void ConstructRelationMatrixStructure(typename TSchemeType::Pointer pScheme, TSystemMatrixType &amp;rT, ModelPart &amp;rModelPart)</div><div class="ttdoc">This function is exactly same as the ConstructMatrixStructure() function in base class except that th...</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:956</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_ab9c1fb8f6d6ae982b4386bb2e625bd23"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ab9c1fb8f6d6ae982b4386bb2e625bd23">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::AssignSettings</a></div><div class="ttdeci">void AssignSettings(const Parameters ThisParameters) override</div><div class="ttdoc">This method assigns settings to member variables.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:1468</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_abbf8fabbf7de8150e696b3fb7804759c"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abbf8fabbf7de8150e696b3fb7804759c">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::TSystemVectorPointerType</a></div><div class="ttdeci">BaseType::TSystemVectorPointerType TSystemVectorPointerType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:123</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_abd6f51d3af05575056ee39c0a92be8ff"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#abd6f51d3af05575056ee39c0a92be8ff">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::VectorIndexType</a></div><div class="ttdeci">std::vector&lt; IndexType &gt; VectorIndexType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:148</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_ac9503b6d8280e5e7215495d05db12be2"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ac9503b6d8280e5e7215495d05db12be2">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::SetUpDofSetWithConstraints</a></div><div class="ttdeci">void SetUpDofSetWithConstraints(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart)</div><div class="ttdoc">Builds the list of the DofSets involved in the problem by &quot;asking&quot; to each element and condition its ...</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:577</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_aca7c6a916ab458a8bc83a9f26c658a04"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aca7c6a916ab458a8bc83a9f26c658a04">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::Info</a></div><div class="ttdeci">std::string Info() const override</div><div class="ttdoc">Turn back information as a string.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:354</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_ad2ed4c63bee6cb6824710e29e367f145"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad2ed4c63bee6cb6824710e29e367f145">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::DofsArrayType</a></div><div class="ttdeci">BaseType::DofsArrayType DofsArrayType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:117</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_ad57451ea05aecad680fa5936b2cce345"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ad57451ea05aecad680fa5936b2cce345">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::SizeType</a></div><div class="ttdeci">std::size_t SizeType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:111</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_adf73cc405bc18f8d9f2e75ae9acc40db"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#adf73cc405bc18f8d9f2e75ae9acc40db">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::BuildAndSolveWithConstraints</a></div><div class="ttdeci">void BuildAndSolveWithConstraints(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;rA, TSystemVectorType &amp;rDx, TSystemVectorType &amp;rb)</div><div class="ttdoc">The same methods as the base class but with constraints.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:458</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_ae3d82886b36bfd00f60b8b8e48d971be"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae3d82886b36bfd00f60b8b8e48d971be">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::BuildRHSWithConstraints</a></div><div class="ttdeci">void BuildRHSWithConstraints(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemVectorType &amp;rb)</div><div class="ttdoc">The same methods as the base class but with constraints.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:524</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_ae469a111c2b8079ba9f70e7785406d36"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae469a111c2b8079ba9f70e7785406d36">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::LocalSystemVectorType</a></div><div class="ttdeci">BaseType::LocalSystemVectorType LocalSystemVectorType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:120</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_ae53685aa212c829c1cf72f4021e46c27"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#ae53685aa212c829c1cf72f4021e46c27">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::~ResidualBasedEliminationBuilderAndSolverWithConstraints</a></div><div class="ttdeci">~ResidualBasedEliminationBuilderAndSolverWithConstraints() override</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:195</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_aeb835754600529a2305ce8945a96a24e"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#aeb835754600529a2305ce8945a96a24e">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::Name</a></div><div class="ttdeci">static std::string Name()</div><div class="ttdoc">Returns the name of the class as used in the settings (snake_case format)</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:336</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_af6b75a165bfd38e73b47dcb675072986"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#af6b75a165bfd38e73b47dcb675072986">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::TSystemMatrixType</a></div><div class="ttdeci">BaseType::TSystemMatrixType TSystemMatrixType</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:118</div></div>
<div class="ttc" id="aclass_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints_html_afc1ddf72d10ff9701c8cde25a24c7e46"><div class="ttname"><a href="../../d2/da4/class_kratos_1_1_residual_based_elimination_builder_and_solver_with_constraints.html#afc1ddf72d10ff9701c8cde25a24c7e46">Kratos::ResidualBasedEliminationBuilderAndSolverWithConstraints::PrintData</a></div><div class="ttdeci">void PrintData(std::ostream &amp;rOStream) const override</div><div class="ttdoc">Print object's data.</div><div class="ttdef"><b>Definition:</b> residualbased_elimination_builder_and_solver_with_constraints.h:366</div></div>
<div class="ttc" id="aclass_kratos_1_1_scheme_html"><div class="ttname"><a href="../../d1/da3/class_kratos_1_1_scheme.html">Kratos::Scheme</a></div><div class="ttdoc">This class provides the implementation of the basic tasks that are needed by the solution strategy.</div><div class="ttdef"><b>Definition:</b> scheme.h:58</div></div>
<div class="ttc" id="aclass_kratos_1_1_sparse_matrix_multiplication_utility_html_ad20f647f5fd3142300bcc1145c25fb01"><div class="ttname"><a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ad20f647f5fd3142300bcc1145c25fb01">Kratos::SparseMatrixMultiplicationUtility::MatrixMultiplication</a></div><div class="ttdeci">static void MatrixMultiplication(const AMatrix &amp;rA, const BMatrix &amp;rB, CMatrix &amp;rC)</div><div class="ttdoc">Matrix-matrix product C = A·B @detail This method uses a template for each matrix.</div><div class="ttdef"><b>Definition:</b> sparse_matrix_multiplication_utility.h:117</div></div>
<div class="ttc" id="aclass_model_part_html"><div class="ttname"><a href="../../d4/d5e/class_model_part.html">ModelPart</a></div><div class="ttdoc">This class aims to manage meshes for multi-physics simulations.</div></div>
<div class="ttc" id="aclass_parameters_html"><div class="ttname"><a href="../../da/d39/class_parameters.html">Parameters</a></div><div class="ttdoc">This class provides to Kratos a data structure for I/O based on the standard of JSON.</div></div>
<div class="ttc" id="aconstraint__utilities_8h_html"><div class="ttname"><a href="../../d8/dea/constraint__utilities_8h.html">constraint_utilities.h</a></div></div>
<div class="ttc" id="adefine_8h_html_a5eac541f5e39bf0360a12f51f0248513"><div class="ttname"><a href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a></div><div class="ttdeci">#define KRATOS_CATCH(MoreInfo)</div><div class="ttdef"><b>Definition:</b> define.h:108</div></div>
<div class="ttc" id="adefine_8h_html_ab9c29d6a0d19ff26bbc4e45e3181fb3f"><div class="ttname"><a href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div><div class="ttdeci">#define KRATOS_TRY</div><div class="ttdef"><b>Definition:</b> define.h:107</div></div>
<div class="ttc" id="agroup___kratos_core_html_ga1ba1e34f0af6a7cfcfa9b43e1f8e8c91"><div class="ttname"><a href="../../d5/d4d/group___kratos_core.html#ga1ba1e34f0af6a7cfcfa9b43e1f8e8c91">Kratos::IndexType</a></div><div class="ttdeci">std::size_t IndexType</div><div class="ttdoc">The definition of the index type.</div><div class="ttdef"><b>Definition:</b> key_hash.h:37</div></div>
<div class="ttc" id="agroup___kratos_core_html_ga376e02451bc7cc3a5fd77b57f0549e6b"><div class="ttname"><a href="../../d5/d4d/group___kratos_core.html#ga376e02451bc7cc3a5fd77b57f0549e6b">KRATOS_ERROR</a></div><div class="ttdeci">#define KRATOS_ERROR</div><div class="ttdef"><b>Definition:</b> exception.h:161</div></div>
<div class="ttc" id="agroup___kratos_core_html_ga421c079910a05f8a88688b045190ac9b"><div class="ttname"><a href="../../d5/d4d/group___kratos_core.html#ga421c079910a05f8a88688b045190ac9b">KRATOS_ERROR_IF_NOT</a></div><div class="ttdeci">#define KRATOS_ERROR_IF_NOT(conditional)</div><div class="ttdef"><b>Definition:</b> exception.h:163</div></div>
<div class="ttc" id="agroup___kratos_core_html_ga9fdd4e0364598f28a529107663707cf3"><div class="ttname"><a href="../../d5/d4d/group___kratos_core.html#ga9fdd4e0364598f28a529107663707cf3">KRATOS_ERROR_IF</a></div><div class="ttdeci">#define KRATOS_ERROR_IF(conditional)</div><div class="ttdef"><b>Definition:</b> exception.h:162</div></div>
<div class="ttc" id="agroup___kratos_core_html_gaf4e978eeb9eea72104d5740bba04411f"><div class="ttname"><a href="../../d5/d4d/group___kratos_core.html#gaf4e978eeb9eea72104d5740bba04411f">KRATOS_DEBUG_ERROR_IF_NOT</a></div><div class="ttdeci">#define KRATOS_DEBUG_ERROR_IF_NOT(conditional)</div><div class="ttdef"><b>Definition:</b> exception.h:172</div></div>
<div class="ttc" id="alogger_8h_html"><div class="ttname"><a href="../../d1/d8c/logger_8h.html">logger.h</a></div></div>
<div class="ttc" id="alogger_8h_html_a77c49181bec73a59e8ad275f8a56cdd0"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a></div><div class="ttdeci">#define KRATOS_INFO_IF(label, conditional)</div><div class="ttdef"><b>Definition:</b> logger.h:251</div></div>
<div class="ttc" id="alogger_8h_html_af0e287de83134e4e7461c80c5395be73"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#af0e287de83134e4e7461c80c5395be73">KRATOS_WARNING_IF</a></div><div class="ttdeci">#define KRATOS_WARNING_IF(label, conditional)</div><div class="ttdef"><b>Definition:</b> logger.h:266</div></div>
<div class="ttc" id="anamespace_kratos_1_1_constraint_utilities_html_a9322ce7618f2779ee5c6171d0d9d3303"><div class="ttname"><a href="../../d3/da5/namespace_kratos_1_1_constraint_utilities.html#a9322ce7618f2779ee5c6171d0d9d3303">Kratos::ConstraintUtilities::ApplyConstraints</a></div><div class="ttdeci">void ApplyConstraints(ModelPart &amp;rModelPart)</div><div class="ttdef"><b>Definition:</b> constraint_utilities.cpp:100</div></div>
<div class="ttc" id="anamespace_kratos_1_1_constraint_utilities_html_ad37af926e550038d34dedb258fa4daad"><div class="ttname"><a href="../../d3/da5/namespace_kratos_1_1_constraint_utilities.html#ad37af926e550038d34dedb258fa4daad">Kratos::ConstraintUtilities::ResetSlaveDofs</a></div><div class="ttdeci">void ResetSlaveDofs(ModelPart &amp;rModelPart)</div><div class="ttdef"><b>Definition:</b> constraint_utilities.cpp:71</div></div>
<div class="ttc" id="anamespace_kratos_1_1_mortar_utilities_html_a945773babf1a22ee5a6abec98284a460"><div class="ttname"><a href="../../da/dec/namespace_kratos_1_1_mortar_utilities.html#a945773babf1a22ee5a6abec98284a460">Kratos::MortarUtilities::rDx</a></div><div class="ttdeci">void const TVarType Vector &amp; rDx</div><div class="ttdef"><b>Definition:</b> mortar_utilities.h:592</div></div>
<div class="ttc" id="anamespace_kratos_1_1_mortar_utilities_html_ab760d3f1c6c454fff50350af7ec2dc7a"><div class="ttname"><a href="../../da/dec/namespace_kratos_1_1_mortar_utilities.html#ab760d3f1c6c454fff50350af7ec2dc7a">Kratos::MortarUtilities::Index</a></div><div class="ttdeci">void const TVarType Vector const std::size_t Index</div><div class="ttdef"><b>Definition:</b> mortar_utilities.h:593</div></div>
<div class="ttc" id="anamespace_kratos_1_1_rans_variable_utilities_html_a59c7e204dd415b212e4726b5e2bcbc82"><div class="ttname"><a href="../../db/d91/namespace_kratos_1_1_rans_variable_utilities.html#a59c7e204dd415b212e4726b5e2bcbc82">Kratos::RansVariableUtilities::rModelPart</a></div><div class="ttdeci">std::tuple&lt; unsigned int, unsigned int &gt; const double const Variable&lt; double &gt; ModelPart &amp; rModelPart</div><div class="ttdef"><b>Definition:</b> rans_variable_utilities.h:44</div></div>
<div class="ttc" id="anamespace_kratos_html"><div class="ttname"><a href="../../db/d66/namespace_kratos.html">Kratos</a></div><div class="ttdoc">REF: G. R. Cowper, GAUSSIAN QUADRATURE FORMULAS FOR TRIANGLES.</div><div class="ttdef"><b>Definition:</b> mesh_condition.cpp:21</div></div>
<div class="ttc" id="anamespace_kratos_html_a07ef8a5b8886ded903a1e7ad4c0df960"><div class="ttname"><a href="../../db/d66/namespace_kratos.html#a07ef8a5b8886ded903a1e7ad4c0df960">Kratos::block_for_each</a></div><div class="ttdeci">void block_for_each(TContainerType &amp;&amp;v, TFunctionType &amp;&amp;func)</div><div class="ttdoc">simplified version of the basic loop (without reduction) to enable template type deduction</div><div class="ttdef"><b>Definition:</b> parallel_utilities.h:304</div></div>
<div class="ttc" id="anamespace_kratos_html_a127b39e29fd77f2e39373d00dc48e571"><div class="ttname"><a href="../../db/d66/namespace_kratos.html#a127b39e29fd77f2e39373d00dc48e571">Kratos::AtomicAdd</a></div><div class="ttdeci">void AtomicAdd(TDataType &amp;target, const TDataType &amp;value)</div><div class="ttdef"><b>Definition:</b> atomic_utilities.h:55</div></div>
<div class="ttc" id="anamespace_kratos_html_a1514eea722d243fa5561f7050c071b9fa72b048930550a0e11889dd0ac17b0439"><div class="ttname"><a href="../../db/d66/namespace_kratos.html#a1514eea722d243fa5561f7050c071b9fa72b048930550a0e11889dd0ac17b0439">Kratos::DataLocation::ProcessInfo</a></div><div class="ttdeci">@ ProcessInfo</div></div>
<div class="ttc" id="anamespace_kratos_html_a93c726046cc93621bfee008f1bc8265f"><div class="ttname"><a href="../../db/d66/namespace_kratos.html#a93c726046cc93621bfee008f1bc8265f">Kratos::rA</a></div><div class="ttdeci">void TUblasSparseSpace&lt; double &gt;::MatrixType &amp; rA</div><div class="ttdef"><b>Definition:</b> amgcl_solver.h:84</div></div>
<div class="ttc" id="anamespacegenerate__total__lagrangian__mixed__volumetric__strain__element_html_a6ca56ca9ce0b393e572ef7e35fd945e1"><div class="ttname"><a href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a6ca56ca9ce0b393e572ef7e35fd945e1">generate_total_lagrangian_mixed_volumetric_strain_element.local_size</a></div><div class="ttdeci">dim local_size</div><div class="ttdef"><b>Definition:</b> generate_total_lagrangian_mixed_volumetric_strain_element.py:17</div></div>
<div class="ttc" id="anamespacegenerate__total__lagrangian__mixed__volumetric__strain__element_html_adcabf3b15773ccd9b7cd71986b6a9b10"><div class="ttname"><a href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#adcabf3b15773ccd9b7cd71986b6a9b10">generate_total_lagrangian_mixed_volumetric_strain_element.u</a></div><div class="ttdeci">DefineMatrix u</div><div class="ttdef"><b>Definition:</b> generate_total_lagrangian_mixed_volumetric_strain_element.py:30</div></div>
<div class="ttc" id="anamespaceode__solve_html_a3c949810f9da8ea09afa47003dedc1e3"><div class="ttname"><a href="../../d2/df2/namespaceode__solve.html#a3c949810f9da8ea09afa47003dedc1e3">ode_solve.dof</a></div><div class="ttdeci">int dof</div><div class="ttdef"><b>Definition:</b> ode_solve.py:393</div></div>
<div class="ttc" id="anamespacequadrature_html_a56123f01f0d1e776d9a6d85aa0f27caa"><div class="ttname"><a href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">quadrature.k</a></div><div class="ttdeci">int k</div><div class="ttdef"><b>Definition:</b> quadrature.py:595</div></div>
<div class="ttc" id="anamespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t_html_a37fe67255f2e1d30f90f0f02ceb60616"><div class="ttname"><a href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">script_THERMAL_CORRECT.counter</a></div><div class="ttdeci">int counter</div><div class="ttdef"><b>Definition:</b> script_THERMAL_CORRECT.py:218</div></div>
<div class="ttc" id="anamespacetensors_html_a15a1da80aa773e2015eba781cababe05"><div class="ttname"><a href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">tensors::i</a></div><div class="ttdeci">integer i</div><div class="ttdef"><b>Definition:</b> TensorModule.f:17</div></div>
<div class="ttc" id="anamespacetimer_html"><div class="ttname"><a href="../../d5/d83/namespacetimer.html">timer</a></div><div class="ttdef"><b>Definition:</b> timer.py:1</div></div>
<div class="ttc" id="aparallel__utilities_8h_html"><div class="ttname"><a href="../../de/d07/parallel__utilities_8h.html">parallel_utilities.h</a></div></div>
<div class="ttc" id="aresidualbased__elimination__builder__and__solver_8h_html"><div class="ttname"><a href="../../dc/d74/residualbased__elimination__builder__and__solver_8h.html">residualbased_elimination_builder_and_solver.h</a></div></div>
<div class="ttc" id="asparse__matrix__multiplication__utility_8h_html"><div class="ttname"><a href="../../d5/d4e/sparse__matrix__multiplication__utility_8h.html">sparse_matrix_multiplication_utility.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 2 2023 08:42:34 for KratosMultiphysics by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
